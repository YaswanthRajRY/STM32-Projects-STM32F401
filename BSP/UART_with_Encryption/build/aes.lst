ARM GAS  /tmp/ccwvKy3T.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"aes.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.sub_bytes,"ax",%progbits
  18              		.align	1
  19              		.arch armv7e-m
  20              		.syntax unified
  21              		.thumb
  22              		.thumb_func
  23              		.fpu fpv4-sp-d16
  25              	sub_bytes:
  26              	.LVL0:
  27              	.LFB134:
  28              		.file 1 "src/aes.c"
   1:src/aes.c     **** #include "aes.h"
   2:src/aes.c     **** 
   3:src/aes.c     **** static uint8_t key[16] = KEY;
   4:src/aes.c     **** static uint8_t cipher_text[16];
   5:src/aes.c     **** static uint8_t decrypted_text[16];
   6:src/aes.c     **** static uint32_t key_expansion[44];
   7:src/aes.c     **** 
   8:src/aes.c     **** static const uint32_t round_constant[11] = {   0x00000000, 0x01000000, 0x02000000,
   9:src/aes.c     ****                                         0x04000000, 0x08000000, 0x10000000, 0x20000000, 
  10:src/aes.c     ****                                         0x40000000, 0x80000000, 0x1B000000, 0x36000000
  11:src/aes.c     ****                                     };
  12:src/aes.c     **** 
  13:src/aes.c     **** 
  14:src/aes.c     **** 
  15:src/aes.c     **** static const uint8_t s_box[256] =  {   0x63, 0x7c, 0x77, 0x7b, 0xf2, 0x6b, 0x6f, 0xc5, 0x30, 0x01, 
  16:src/aes.c     ****                                 0xca, 0x82, 0xc9, 0x7d, 0xfa, 0x59, 0x47, 0xf0, 0xad, 0xd4, 0xa2, 0
  17:src/aes.c     ****                                 0xb7, 0xfd, 0x93, 0x26, 0x36, 0x3f, 0xf7, 0xcc, 0x34, 0xa5, 0xe5, 0
  18:src/aes.c     ****                                 0x04, 0xc7, 0x23, 0xc3, 0x18, 0x96, 0x05, 0x9a, 0x07, 0x12, 0x80, 0
  19:src/aes.c     ****                                 0x09, 0x83, 0x2c, 0x1a, 0x1b, 0x6e, 0x5a, 0xa0, 0x52, 0x3b, 0xd6, 0
  20:src/aes.c     ****                                 0x53, 0xd1, 0x00, 0xed, 0x20, 0xfc, 0xb1, 0x5b, 0x6a, 0xcb, 0xbe, 0
  21:src/aes.c     ****                                 0xd0, 0xef, 0xaa, 0xfb, 0x43, 0x4d, 0x33, 0x85, 0x45, 0xf9, 0x02, 0
  22:src/aes.c     ****                                 0x51, 0xa3, 0x40, 0x8f, 0x92, 0x9d, 0x38, 0xf5, 0xbc, 0xb6, 0xda, 0
  23:src/aes.c     ****                                 0xcd, 0x0c, 0x13, 0xec, 0x5f, 0x97, 0x44, 0x17, 0xc4, 0xa7, 0x7e, 0
  24:src/aes.c     ****                                 0x60, 0x81, 0x4f, 0xdc, 0x22, 0x2a, 0x90, 0x88, 0x46, 0xee, 0xb8, 0
  25:src/aes.c     ****                                 0xe0, 0x32, 0x3a, 0x0a, 0x49, 0x06, 0x24, 0x5c, 0xc2, 0xd3, 0xac, 0
  26:src/aes.c     ****                                 0xe7, 0xc8, 0x37, 0x6d, 0x8d, 0xd5, 0x4e, 0xa9, 0x6c, 0x56, 0xf4, 0
  27:src/aes.c     ****                                 0xba, 0x78, 0x25, 0x2e, 0x1c, 0xa6, 0xb4, 0xc6, 0xe8, 0xdd, 0x74, 0
  28:src/aes.c     ****                                 0x70, 0x3e, 0xb5, 0x66, 0x48, 0x03, 0xf6, 0x0e, 0x61, 0x35, 0x57, 0
  29:src/aes.c     ****                                 0xe1, 0xf8, 0x98, 0x11, 0x69, 0xd9, 0x8e, 0x94, 0x9b, 0x1e, 0x87, 0
  30:src/aes.c     ****                                 0x8c, 0xa1, 0x89, 0x0d, 0xbf, 0xe6, 0x42, 0x68, 0x41, 0x99, 0x2d, 0
ARM GAS  /tmp/ccwvKy3T.s 			page 2


  31:src/aes.c     ****                             };
  32:src/aes.c     **** 
  33:src/aes.c     **** static const uint8_t inv_s_box[256] =  {   0x52, 0x09, 0x6A, 0xD5, 0x30, 0x36, 0xA5, 0x38, 0xBF, 0x
  34:src/aes.c     ****                                     0x7C, 0xE3, 0x39, 0x82, 0x9B, 0x2F, 0xFF, 0x87, 0x34, 0x8E, 0x4
  35:src/aes.c     ****                                     0x54, 0x7B, 0x94, 0x32, 0xA6, 0xC2, 0x23, 0x3D, 0xEE, 0x4C, 0x9
  36:src/aes.c     ****                                     0x08, 0x2E, 0xA1, 0x66, 0x28, 0xD9, 0x24, 0xB2, 0x76, 0x5B, 0xA
  37:src/aes.c     ****                                     0x72, 0xF8, 0xF6, 0x64, 0x86, 0x68, 0x98, 0x16, 0xD4, 0xA4, 0x5
  38:src/aes.c     ****                                     0x6C, 0x70, 0x48, 0x50, 0xFD, 0xED, 0xB9, 0xDA, 0x5E, 0x15, 0x4
  39:src/aes.c     ****                                     0x90, 0xD8, 0xAB, 0x00, 0x8C, 0xBC, 0xD3, 0x0A, 0xF7, 0xE4, 0x5
  40:src/aes.c     ****                                     0xD0, 0x2C, 0x1E, 0x8F, 0xCA, 0x3F, 0x0F, 0x02, 0xC1, 0xAF, 0xB
  41:src/aes.c     ****                                     0x3A, 0x91, 0x11, 0x41, 0x4F, 0x67, 0xDC, 0xEA, 0x97, 0xF2, 0xC
  42:src/aes.c     ****                                     0x96, 0xAC, 0x74, 0x22, 0xE7, 0xAD, 0x35, 0x85, 0xE2, 0xF9, 0x3
  43:src/aes.c     ****                                     0x47, 0xF1, 0x1A, 0x71, 0x1D, 0x29, 0xC5, 0x89, 0x6F, 0xB7, 0x6
  44:src/aes.c     ****                                     0xFC, 0x56, 0x3E, 0x4B, 0xC6, 0xD2, 0x79, 0x20, 0x9A, 0xDB, 0xC
  45:src/aes.c     ****                                     0x1F, 0xDD, 0xA8, 0x33, 0x88, 0x07, 0xC7, 0x31, 0xB1, 0x12, 0x1
  46:src/aes.c     ****                                     0x60, 0x51, 0x7F, 0xA9, 0x19, 0xB5, 0x4A, 0x0D, 0x2D, 0xE5, 0x7
  47:src/aes.c     ****                                     0xA0, 0xE0, 0x3B, 0x4D, 0xAE, 0x2A, 0xF5, 0xB0, 0xC8, 0xEB, 0xB
  48:src/aes.c     ****                                     0x17, 0x2B, 0x04, 0x7E, 0xBA, 0x77, 0xD6, 0x26, 0xE1, 0x69, 0x1
  49:src/aes.c     ****                                 };
  50:src/aes.c     **** 
  51:src/aes.c     **** 
  52:src/aes.c     **** static const uint8_t mix_col[16] = {   0x02, 0x03, 0x01, 0x01,
  53:src/aes.c     ****                                 0x01, 0x02, 0x03, 0x01,
  54:src/aes.c     ****                                 0x01, 0x01, 0x02, 0x03,
  55:src/aes.c     ****                                 0x03, 0x01, 0x01, 0x02
  56:src/aes.c     ****                             };
  57:src/aes.c     **** 
  58:src/aes.c     **** static const uint8_t inv_mix_col[16] = {   0x0e, 0x0b, 0x0d, 0x09,
  59:src/aes.c     ****                                     0x09, 0x0e, 0x0b, 0x0d,
  60:src/aes.c     ****                                     0x0d, 0x09, 0x0e, 0x0b,
  61:src/aes.c     ****                                     0x0b, 0x0d, 0x09, 0x0e
  62:src/aes.c     ****                                 };
  63:src/aes.c     **** 
  64:src/aes.c     **** /**
  65:src/aes.c     ****  * 
  66:src/aes.c     ****  */
  67:src/aes.c     **** static void sub_bytes(uint8_t* state, uint8_t size)
  68:src/aes.c     **** {
  29              		.loc 1 68 1 view -0
  30              		.cfi_startproc
  31              		@ args = 0, pretend = 0, frame = 0
  32              		@ frame_needed = 0, uses_anonymous_args = 0
  33              		@ link register save eliminated.
  69:src/aes.c     ****     for (int i=0; i<size; i++)
  34              		.loc 1 69 5 view .LVU1
  35              	.LBB2:
  36              		.loc 1 69 10 view .LVU2
  37              		.loc 1 69 14 is_stmt 0 view .LVU3
  38 0000 0023     		movs	r3, #0
  39              	.LVL1:
  40              		.loc 1 69 19 is_stmt 1 view .LVU4
  41              		.loc 1 69 5 is_stmt 0 view .LVU5
  42 0002 9942     		cmp	r1, r3
  43 0004 0FDD     		ble	.L7
  44              	.LBE2:
  68:src/aes.c     ****     for (int i=0; i<size; i++)
  45              		.loc 1 68 1 view .LVU6
ARM GAS  /tmp/ccwvKy3T.s 			page 3


  46 0006 10B4     		push	{r4}
  47              	.LCFI0:
  48              		.cfi_def_cfa_offset 4
  49              		.cfi_offset 4, -4
  50              	.L3:
  51              	.LBB4:
  52              	.LBB3:
  70:src/aes.c     ****     {
  71:src/aes.c     ****         uint8_t upper_nibble = (state[i] >> 4) & 0xF;
  53              		.loc 1 71 9 is_stmt 1 discriminator 3 view .LVU7
  54              		.loc 1 71 38 is_stmt 0 discriminator 3 view .LVU8
  55 0008 C25C     		ldrb	r2, [r0, r3]	@ zero_extendqisi2
  56              	.LVL2:
  72:src/aes.c     ****         uint8_t lower_nibble = state[i] & 0xF;
  57              		.loc 1 72 9 is_stmt 1 discriminator 3 view .LVU9
  58              		.loc 1 72 17 is_stmt 0 discriminator 3 view .LVU10
  59 000a 02F00F0C 		and	ip, r2, #15
  60              	.LVL3:
  73:src/aes.c     **** 
  74:src/aes.c     ****         state[i] = s_box[(upper_nibble*16) + lower_nibble];
  61              		.loc 1 74 9 is_stmt 1 discriminator 3 view .LVU11
  62              		.loc 1 74 39 is_stmt 0 discriminator 3 view .LVU12
  63 000e 02F0F002 		and	r2, r2, #240
  64              	.LVL4:
  65              		.loc 1 74 44 discriminator 3 view .LVU13
  66 0012 6244     		add	r2, r2, ip
  67              		.loc 1 74 25 discriminator 3 view .LVU14
  68 0014 044C     		ldr	r4, .L8
  69 0016 A25C     		ldrb	r2, [r4, r2]	@ zero_extendqisi2
  70              		.loc 1 74 18 discriminator 3 view .LVU15
  71 0018 C254     		strb	r2, [r0, r3]
  72              	.LVL5:
  73              		.loc 1 74 18 discriminator 3 view .LVU16
  74              	.LBE3:
  69:src/aes.c     ****     {
  75              		.loc 1 69 27 is_stmt 1 discriminator 3 view .LVU17
  69:src/aes.c     ****     {
  76              		.loc 1 69 28 is_stmt 0 discriminator 3 view .LVU18
  77 001a 0133     		adds	r3, r3, #1
  78              	.LVL6:
  69:src/aes.c     ****     {
  79              		.loc 1 69 19 is_stmt 1 discriminator 3 view .LVU19
  69:src/aes.c     ****     {
  80              		.loc 1 69 5 is_stmt 0 discriminator 3 view .LVU20
  81 001c 9942     		cmp	r1, r3
  82 001e F3DC     		bgt	.L3
  83              	.LBE4:
  75:src/aes.c     ****     }
  76:src/aes.c     **** }
  84              		.loc 1 76 1 view .LVU21
  85 0020 5DF8044B 		ldr	r4, [sp], #4
  86              	.LCFI1:
  87              		.cfi_restore 4
  88              		.cfi_def_cfa_offset 0
  89 0024 7047     		bx	lr
  90              	.LVL7:
  91              	.L7:
ARM GAS  /tmp/ccwvKy3T.s 			page 4


  92              		.loc 1 76 1 view .LVU22
  93 0026 7047     		bx	lr
  94              	.L9:
  95              		.align	2
  96              	.L8:
  97 0028 00000000 		.word	.LANCHOR0
  98              		.cfi_endproc
  99              	.LFE134:
 101              		.section	.text.compute_g,"ax",%progbits
 102              		.align	1
 103              		.syntax unified
 104              		.thumb
 105              		.thumb_func
 106              		.fpu fpv4-sp-d16
 108              	compute_g:
 109              	.LVL8:
 110              	.LFB135:
  77:src/aes.c     **** 
  78:src/aes.c     **** /**
  79:src/aes.c     ****  * 
  80:src/aes.c     ****  */
  81:src/aes.c     **** static uint32_t compute_g(uint32_t word, uint8_t r)
  82:src/aes.c     **** {
 111              		.loc 1 82 1 is_stmt 1 view -0
 112              		.cfi_startproc
 113              		@ args = 0, pretend = 0, frame = 8
 114              		@ frame_needed = 0, uses_anonymous_args = 0
 115              		.loc 1 82 1 is_stmt 0 view .LVU24
 116 0000 10B5     		push	{r4, lr}
 117              	.LCFI2:
 118              		.cfi_def_cfa_offset 8
 119              		.cfi_offset 4, -8
 120              		.cfi_offset 14, -4
 121 0002 82B0     		sub	sp, sp, #8
 122              	.LCFI3:
 123              		.cfi_def_cfa_offset 16
 124 0004 0190     		str	r0, [sp, #4]
 125 0006 0C46     		mov	r4, r1
  83:src/aes.c     ****     uint8_t lsb = (word >> 24) & 0xFF;
 126              		.loc 1 83 5 is_stmt 1 view .LVU25
 127              	.LVL9:
  84:src/aes.c     ****     word = word << 8;
 128              		.loc 1 84 5 view .LVU26
 129              		.loc 1 84 17 is_stmt 0 view .LVU27
 130 0008 0302     		lsls	r3, r0, #8
 131              		.loc 1 84 10 view .LVU28
 132 000a 0193     		str	r3, [sp, #4]
  85:src/aes.c     ****     word = word | lsb;
 133              		.loc 1 85 5 is_stmt 1 view .LVU29
 134              		.loc 1 85 17 is_stmt 0 view .LVU30
 135 000c 43EA1063 		orr	r3, r3, r0, lsr #24
 136              		.loc 1 85 10 view .LVU31
 137 0010 0193     		str	r3, [sp, #4]
  86:src/aes.c     ****     
  87:src/aes.c     ****     uint8_t* base = (uint8_t*)&word;
 138              		.loc 1 87 5 is_stmt 1 view .LVU32
 139              	.LVL10:
ARM GAS  /tmp/ccwvKy3T.s 			page 5


  88:src/aes.c     **** 
  89:src/aes.c     ****     sub_bytes(base, 4);
 140              		.loc 1 89 5 view .LVU33
 141 0012 0421     		movs	r1, #4
 142              	.LVL11:
 143              		.loc 1 89 5 is_stmt 0 view .LVU34
 144 0014 0DEB0100 		add	r0, sp, r1
 145              	.LVL12:
 146              		.loc 1 89 5 view .LVU35
 147 0018 FFF7FEFF 		bl	sub_bytes
 148              	.LVL13:
  90:src/aes.c     **** 
  91:src/aes.c     ****     return (word ^ round_constant[r]);
 149              		.loc 1 91 5 is_stmt 1 view .LVU36
 150              		.loc 1 91 34 is_stmt 0 view .LVU37
 151 001c 034B     		ldr	r3, .L12
 152 001e 53F82400 		ldr	r0, [r3, r4, lsl #2]
  92:src/aes.c     **** }
 153              		.loc 1 92 1 view .LVU38
 154 0022 019B     		ldr	r3, [sp, #4]
 155 0024 5840     		eors	r0, r0, r3
 156 0026 02B0     		add	sp, sp, #8
 157              	.LCFI4:
 158              		.cfi_def_cfa_offset 8
 159              		@ sp needed
 160 0028 10BD     		pop	{r4, pc}
 161              	.LVL14:
 162              	.L13:
 163              		.loc 1 92 1 view .LVU39
 164 002a 00BF     		.align	2
 165              	.L12:
 166 002c 00000000 		.word	.LANCHOR1
 167              		.cfi_endproc
 168              	.LFE135:
 170              		.section	.text.expand_key,"ax",%progbits
 171              		.align	1
 172              		.syntax unified
 173              		.thumb
 174              		.thumb_func
 175              		.fpu fpv4-sp-d16
 177              	expand_key:
 178              	.LVL15:
 179              	.LFB136:
  93:src/aes.c     **** 
  94:src/aes.c     **** /**
  95:src/aes.c     ****  * 
  96:src/aes.c     ****  */
  97:src/aes.c     **** static void expand_key(uint32_t* word, uint8_t* k)
  98:src/aes.c     **** {
 180              		.loc 1 98 1 is_stmt 1 view -0
 181              		.cfi_startproc
 182              		@ args = 0, pretend = 0, frame = 0
 183              		@ frame_needed = 0, uses_anonymous_args = 0
 184              		.loc 1 98 1 is_stmt 0 view .LVU41
 185 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 186              	.LCFI5:
 187              		.cfi_def_cfa_offset 24
ARM GAS  /tmp/ccwvKy3T.s 			page 6


 188              		.cfi_offset 3, -24
 189              		.cfi_offset 4, -20
 190              		.cfi_offset 5, -16
 191              		.cfi_offset 6, -12
 192              		.cfi_offset 7, -8
 193              		.cfi_offset 14, -4
 194 0002 0446     		mov	r4, r0
  99:src/aes.c     ****     for (int i=0; i<4; i++)
 195              		.loc 1 99 5 is_stmt 1 view .LVU42
 196              	.LBB5:
 197              		.loc 1 99 10 view .LVU43
 198              	.LVL16:
 199              		.loc 1 99 14 is_stmt 0 view .LVU44
 200 0004 0022     		movs	r2, #0
 201              		.loc 1 99 5 view .LVU45
 202 0006 0FE0     		b	.L15
 203              	.LVL17:
 204              	.L16:
 100:src/aes.c     ****     {
 101:src/aes.c     ****         word[i] = (k[i * 4] << 24) | (k[i * 4 + 1] << 16) | (k[i * 4 + 2] << 8) | (k[i * 4 + 3]);
 205              		.loc 1 101 9 is_stmt 1 discriminator 3 view .LVU46
 206              		.loc 1 101 21 is_stmt 0 discriminator 3 view .LVU47
 207 0008 11F82250 		ldrb	r5, [r1, r2, lsl #2]	@ zero_extendqisi2
 208              		.loc 1 101 40 discriminator 3 view .LVU48
 209 000c 01EB8200 		add	r0, r1, r2, lsl #2
 210 0010 4378     		ldrb	r3, [r0, #1]	@ zero_extendqisi2
 211              		.loc 1 101 52 discriminator 3 view .LVU49
 212 0012 1B04     		lsls	r3, r3, #16
 213              		.loc 1 101 36 discriminator 3 view .LVU50
 214 0014 43EA0563 		orr	r3, r3, r5, lsl #24
 215              		.loc 1 101 63 discriminator 3 view .LVU51
 216 0018 8578     		ldrb	r5, [r0, #2]	@ zero_extendqisi2
 217              		.loc 1 101 59 discriminator 3 view .LVU52
 218 001a 43EA0523 		orr	r3, r3, r5, lsl #8
 219              		.loc 1 101 85 discriminator 3 view .LVU53
 220 001e C078     		ldrb	r0, [r0, #3]	@ zero_extendqisi2
 221              		.loc 1 101 81 discriminator 3 view .LVU54
 222 0020 0343     		orrs	r3, r3, r0
 223              		.loc 1 101 17 discriminator 3 view .LVU55
 224 0022 44F82230 		str	r3, [r4, r2, lsl #2]
  99:src/aes.c     ****     for (int i=0; i<4; i++)
 225              		.loc 1 99 24 is_stmt 1 discriminator 3 view .LVU56
  99:src/aes.c     ****     for (int i=0; i<4; i++)
 226              		.loc 1 99 25 is_stmt 0 discriminator 3 view .LVU57
 227 0026 0132     		adds	r2, r2, #1
 228              	.LVL18:
 229              	.L15:
  99:src/aes.c     ****     for (int i=0; i<4; i++)
 230              		.loc 1 99 19 is_stmt 1 discriminator 1 view .LVU58
  99:src/aes.c     ****     for (int i=0; i<4; i++)
 231              		.loc 1 99 5 is_stmt 0 discriminator 1 view .LVU59
 232 0028 032A     		cmp	r2, #3
 233 002a EDDD     		ble	.L16
 234              	.LBE5:
 235              	.LBB6:
 102:src/aes.c     ****     }
 103:src/aes.c     **** 
ARM GAS  /tmp/ccwvKy3T.s 			page 7


 104:src/aes.c     ****     uint8_t round = 0;
 105:src/aes.c     ****     for (int i=4; i<44; i+=4)
 236              		.loc 1 105 14 view .LVU60
 237 002c 0425     		movs	r5, #4
 238              	.LBE6:
 104:src/aes.c     ****     for (int i=4; i<44; i+=4)
 239              		.loc 1 104 13 view .LVU61
 240 002e 0026     		movs	r6, #0
 241 0030 26E0     		b	.L17
 242              	.LVL19:
 243              	.L18:
 244              	.LBB8:
 245              	.LBB7:
 106:src/aes.c     ****     {
 107:src/aes.c     ****         uint32_t g = compute_g(word[i-1], ++round);
 246              		.loc 1 107 9 is_stmt 1 discriminator 3 view .LVU62
 247              		.loc 1 107 36 is_stmt 0 discriminator 3 view .LVU63
 248 0032 05F18047 		add	r7, r5, #1073741824
 249 0036 013F     		subs	r7, r7, #1
 250              		.loc 1 107 18 discriminator 3 view .LVU64
 251 0038 0136     		adds	r6, r6, #1
 252              	.LVL20:
 253              		.loc 1 107 18 discriminator 3 view .LVU65
 254 003a F6B2     		uxtb	r6, r6
 255              	.LVL21:
 256              		.loc 1 107 22 discriminator 3 view .LVU66
 257 003c 3146     		mov	r1, r6
 258 003e 54F82700 		ldr	r0, [r4, r7, lsl #2]
 259 0042 FFF7FEFF 		bl	compute_g
 260              	.LVL22:
 108:src/aes.c     **** 
 109:src/aes.c     ****         word[i] = word[i - 4] ^ g;
 261              		.loc 1 109 9 is_stmt 1 discriminator 3 view .LVU67
 262              		.loc 1 109 23 is_stmt 0 discriminator 3 view .LVU68
 263 0046 05F18042 		add	r2, r5, #1073741824
 264 004a 131F     		subs	r3, r2, #4
 265 004c 54F82330 		ldr	r3, [r4, r3, lsl #2]
 266              		.loc 1 109 31 discriminator 3 view .LVU69
 267 0050 4340     		eors	r3, r3, r0
 268              		.loc 1 109 17 discriminator 3 view .LVU70
 269 0052 44F82530 		str	r3, [r4, r5, lsl #2]
 110:src/aes.c     ****         word[i + 1] = word[i + 1 - 4] ^ word[i];
 270              		.loc 1 110 9 is_stmt 1 discriminator 3 view .LVU71
 271              		.loc 1 110 27 is_stmt 0 discriminator 3 view .LVU72
 272 0056 D11E     		subs	r1, r2, #3
 273 0058 54F82100 		ldr	r0, [r4, r1, lsl #2]
 274              	.LVL23:
 275              		.loc 1 110 13 discriminator 3 view .LVU73
 276 005c 691C     		adds	r1, r5, #1
 277              		.loc 1 110 39 discriminator 3 view .LVU74
 278 005e 4340     		eors	r3, r3, r0
 279              		.loc 1 110 21 discriminator 3 view .LVU75
 280 0060 44F82130 		str	r3, [r4, r1, lsl #2]
 111:src/aes.c     ****         word[i + 2] = word[i + 2 - 4] ^ word[i + 1];
 281              		.loc 1 111 9 is_stmt 1 discriminator 3 view .LVU76
 282              		.loc 1 111 27 is_stmt 0 discriminator 3 view .LVU77
 283 0064 023A     		subs	r2, r2, #2
ARM GAS  /tmp/ccwvKy3T.s 			page 8


 284 0066 54F82200 		ldr	r0, [r4, r2, lsl #2]
 285              		.loc 1 111 13 discriminator 3 view .LVU78
 286 006a AA1C     		adds	r2, r5, #2
 287              		.loc 1 111 39 discriminator 3 view .LVU79
 288 006c 4340     		eors	r3, r3, r0
 289              		.loc 1 111 21 discriminator 3 view .LVU80
 290 006e 44F82230 		str	r3, [r4, r2, lsl #2]
 112:src/aes.c     ****         word[i + 3] = word[i + 3 - 4] ^ word[i + 2];
 291              		.loc 1 112 9 is_stmt 1 discriminator 3 view .LVU81
 292              		.loc 1 112 27 is_stmt 0 discriminator 3 view .LVU82
 293 0072 54F82710 		ldr	r1, [r4, r7, lsl #2]
 294              		.loc 1 112 13 discriminator 3 view .LVU83
 295 0076 EA1C     		adds	r2, r5, #3
 296              		.loc 1 112 39 discriminator 3 view .LVU84
 297 0078 4B40     		eors	r3, r3, r1
 298              		.loc 1 112 21 discriminator 3 view .LVU85
 299 007a 44F82230 		str	r3, [r4, r2, lsl #2]
 300              	.LBE7:
 105:src/aes.c     ****     {
 301              		.loc 1 105 25 is_stmt 1 discriminator 3 view .LVU86
 105:src/aes.c     ****     {
 302              		.loc 1 105 26 is_stmt 0 discriminator 3 view .LVU87
 303 007e 0435     		adds	r5, r5, #4
 304              	.LVL24:
 305              	.L17:
 105:src/aes.c     ****     {
 306              		.loc 1 105 19 is_stmt 1 discriminator 1 view .LVU88
 105:src/aes.c     ****     {
 307              		.loc 1 105 5 is_stmt 0 discriminator 1 view .LVU89
 308 0080 2B2D     		cmp	r5, #43
 309 0082 D6DD     		ble	.L18
 310              	.LBE8:
 113:src/aes.c     ****     }
 114:src/aes.c     **** }
 311              		.loc 1 114 1 view .LVU90
 312 0084 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 313              		.loc 1 114 1 view .LVU91
 314              		.cfi_endproc
 315              	.LFE136:
 317              		.section	.text.add_round_key,"ax",%progbits
 318              		.align	1
 319              		.syntax unified
 320              		.thumb
 321              		.thumb_func
 322              		.fpu fpv4-sp-d16
 324              	add_round_key:
 325              	.LVL25:
 326              	.LFB138:
 115:src/aes.c     **** 
 116:src/aes.c     **** /**
 117:src/aes.c     ****  * 
 118:src/aes.c     ****  */
 119:src/aes.c     **** void aes_init(void)
 120:src/aes.c     **** {
 121:src/aes.c     ****     // Check key length
 122:src/aes.c     ****     int len = 0;
 123:src/aes.c     ****     while (key[len] != '\0') 
ARM GAS  /tmp/ccwvKy3T.s 			page 9


 124:src/aes.c     ****     {
 125:src/aes.c     ****         len++;
 126:src/aes.c     ****     }
 127:src/aes.c     ****     len--;
 128:src/aes.c     **** 
 129:src/aes.c     ****     if (len > 16 || len < 16)
 130:src/aes.c     ****     {
 131:src/aes.c     ****         //printf(" %d Invalid key length! Please enter a 128-bit (16-byte) key for AES-128.\n", len
 132:src/aes.c     ****         //return; // return failed
 133:src/aes.c     ****     }
 134:src/aes.c     **** 
 135:src/aes.c     ****     // Expand the key
 136:src/aes.c     ****     expand_key(key_expansion, key);
 137:src/aes.c     **** }
 138:src/aes.c     **** 
 139:src/aes.c     **** /*---------------------------------------------------------------------------------------------*/
 140:src/aes.c     **** 
 141:src/aes.c     **** /**
 142:src/aes.c     ****  * 
 143:src/aes.c     ****  */
 144:src/aes.c     **** static void add_round_key(uint8_t* state, uint8_t round)
 145:src/aes.c     **** {
 327              		.loc 1 145 1 is_stmt 1 view -0
 328              		.cfi_startproc
 329              		@ args = 0, pretend = 0, frame = 0
 330              		@ frame_needed = 0, uses_anonymous_args = 0
 146:src/aes.c     ****     for (int i = 0; i < 4; i++) 
 331              		.loc 1 146 5 view .LVU93
 332              	.LBB9:
 333              		.loc 1 146 10 view .LVU94
 334              		.loc 1 146 14 is_stmt 0 view .LVU95
 335 0000 0023     		movs	r3, #0
 336              	.LVL26:
 337              		.loc 1 146 21 is_stmt 1 view .LVU96
 338              		.loc 1 146 5 is_stmt 0 view .LVU97
 339 0002 032B     		cmp	r3, #3
 340 0004 26DC     		bgt	.L26
 341              	.LBE9:
 145:src/aes.c     ****     for (int i = 0; i < 4; i++) 
 342              		.loc 1 145 1 view .LVU98
 343 0006 10B5     		push	{r4, lr}
 344              	.LCFI6:
 345              		.cfi_def_cfa_offset 8
 346              		.cfi_offset 4, -8
 347              		.cfi_offset 14, -4
 348              	.L22:
 349              	.LBB11:
 350              	.LBB10:
 147:src/aes.c     ****     {
 148:src/aes.c     ****         uint32_t k = key_expansion[round * 4 + i];
 351              		.loc 1 148 9 is_stmt 1 discriminator 3 view .LVU99
 352              		.loc 1 148 46 is_stmt 0 discriminator 3 view .LVU100
 353 0008 03EB8104 		add	r4, r3, r1, lsl #2
 354              		.loc 1 148 18 discriminator 3 view .LVU101
 355 000c 124A     		ldr	r2, .L27
 356 000e 52F82440 		ldr	r4, [r2, r4, lsl #2]
 357              	.LVL27:
ARM GAS  /tmp/ccwvKy3T.s 			page 10


 149:src/aes.c     **** 
 150:src/aes.c     ****         state[i*4 + 0] ^= (k >> 24) & 0xff;
 358              		.loc 1 150 9 is_stmt 1 discriminator 3 view .LVU102
 359              		.loc 1 150 24 is_stmt 0 discriminator 3 view .LVU103
 360 0012 9A00     		lsls	r2, r3, #2
 361 0014 10F823C0 		ldrb	ip, [r0, r3, lsl #2]	@ zero_extendqisi2
 362 0018 8CEA146C 		eor	ip, ip, r4, lsr #24
 363 001c 00F823C0 		strb	ip, [r0, r3, lsl #2]
 151:src/aes.c     ****         state[i*4 + 1] ^= (k >> 16) & 0xff;
 364              		.loc 1 151 9 is_stmt 1 discriminator 3 view .LVU104
 365              		.loc 1 151 24 is_stmt 0 discriminator 3 view .LVU105
 366 0020 02F1010E 		add	lr, r2, #1
 367 0024 10F80EC0 		ldrb	ip, [r0, lr]	@ zero_extendqisi2
 368 0028 8CEA144C 		eor	ip, ip, r4, lsr #16
 369 002c 00F80EC0 		strb	ip, [r0, lr]
 152:src/aes.c     ****         state[i*4 + 2] ^= (k >> 8) & 0xff;
 370              		.loc 1 152 9 is_stmt 1 discriminator 3 view .LVU106
 371              		.loc 1 152 24 is_stmt 0 discriminator 3 view .LVU107
 372 0030 02F1020E 		add	lr, r2, #2
 373 0034 10F80EC0 		ldrb	ip, [r0, lr]	@ zero_extendqisi2
 374 0038 8CEA142C 		eor	ip, ip, r4, lsr #8
 375 003c 00F80EC0 		strb	ip, [r0, lr]
 153:src/aes.c     ****         state[i*4 + 3] ^= (k >> 0) & 0xff;
 376              		.loc 1 153 9 is_stmt 1 discriminator 3 view .LVU108
 377              		.loc 1 153 24 is_stmt 0 discriminator 3 view .LVU109
 378 0040 0332     		adds	r2, r2, #3
 379 0042 10F802C0 		ldrb	ip, [r0, r2]	@ zero_extendqisi2
 380 0046 8CEA0404 		eor	r4, ip, r4
 381              	.LVL28:
 382              		.loc 1 153 24 discriminator 3 view .LVU110
 383 004a 8454     		strb	r4, [r0, r2]
 384              	.LBE10:
 146:src/aes.c     ****     {
 385              		.loc 1 146 28 is_stmt 1 discriminator 3 view .LVU111
 146:src/aes.c     ****     {
 386              		.loc 1 146 29 is_stmt 0 discriminator 3 view .LVU112
 387 004c 0133     		adds	r3, r3, #1
 388              	.LVL29:
 146:src/aes.c     ****     {
 389              		.loc 1 146 21 is_stmt 1 discriminator 3 view .LVU113
 146:src/aes.c     ****     {
 390              		.loc 1 146 5 is_stmt 0 discriminator 3 view .LVU114
 391 004e 032B     		cmp	r3, #3
 392 0050 DADD     		ble	.L22
 393              	.LBE11:
 154:src/aes.c     ****     }
 155:src/aes.c     **** }
 394              		.loc 1 155 1 view .LVU115
 395 0052 10BD     		pop	{r4, pc}
 396              	.L26:
 397              	.LCFI7:
 398              		.cfi_def_cfa_offset 0
 399              		.cfi_restore 4
 400              		.cfi_restore 14
 401              		.loc 1 155 1 view .LVU116
 402 0054 7047     		bx	lr
 403              	.L28:
ARM GAS  /tmp/ccwvKy3T.s 			page 11


 404 0056 00BF     		.align	2
 405              	.L27:
 406 0058 00000000 		.word	.LANCHOR2
 407              		.cfi_endproc
 408              	.LFE138:
 410              		.section	.text.shift_rows,"ax",%progbits
 411              		.align	1
 412              		.syntax unified
 413              		.thumb
 414              		.thumb_func
 415              		.fpu fpv4-sp-d16
 417              	shift_rows:
 418              	.LVL30:
 419              	.LFB139:
 156:src/aes.c     **** 
 157:src/aes.c     **** /**
 158:src/aes.c     ****  * 
 159:src/aes.c     ****  */
 160:src/aes.c     **** static void shift_rows(uint8_t* state)
 161:src/aes.c     **** {
 420              		.loc 1 161 1 is_stmt 1 view -0
 421              		.cfi_startproc
 422              		@ args = 0, pretend = 0, frame = 16
 423              		@ frame_needed = 0, uses_anonymous_args = 0
 424              		@ link register save eliminated.
 425              		.loc 1 161 1 is_stmt 0 view .LVU118
 426 0000 84B0     		sub	sp, sp, #16
 427              	.LCFI8:
 428              		.cfi_def_cfa_offset 16
 162:src/aes.c     ****     uint8_t tmp[16];
 429              		.loc 1 162 5 is_stmt 1 view .LVU119
 163:src/aes.c     **** 
 164:src/aes.c     ****     // Row 0 (no shift)
 165:src/aes.c     ****     tmp[0]  = state[0];
 430              		.loc 1 165 5 view .LVU120
 431              		.loc 1 165 20 is_stmt 0 view .LVU121
 432 0002 0378     		ldrb	r3, [r0]	@ zero_extendqisi2
 433              		.loc 1 165 13 view .LVU122
 434 0004 8DF80030 		strb	r3, [sp]
 166:src/aes.c     ****     tmp[4]  = state[4];
 435              		.loc 1 166 5 is_stmt 1 view .LVU123
 436              		.loc 1 166 13 is_stmt 0 view .LVU124
 437 0008 0379     		ldrb	r3, [r0, #4]	@ zero_extendqisi2
 438 000a 8DF80430 		strb	r3, [sp, #4]
 167:src/aes.c     ****     tmp[8]  = state[8];
 439              		.loc 1 167 5 is_stmt 1 view .LVU125
 440              		.loc 1 167 13 is_stmt 0 view .LVU126
 441 000e 037A     		ldrb	r3, [r0, #8]	@ zero_extendqisi2
 442 0010 8DF80830 		strb	r3, [sp, #8]
 168:src/aes.c     ****     tmp[12] = state[12];
 443              		.loc 1 168 5 is_stmt 1 view .LVU127
 444              		.loc 1 168 13 is_stmt 0 view .LVU128
 445 0014 037B     		ldrb	r3, [r0, #12]	@ zero_extendqisi2
 446 0016 8DF80C30 		strb	r3, [sp, #12]
 169:src/aes.c     **** 
 170:src/aes.c     ****     // Row 1 (shift left by 1)
 171:src/aes.c     ****     tmp[1]  = state[5];
ARM GAS  /tmp/ccwvKy3T.s 			page 12


 447              		.loc 1 171 5 is_stmt 1 view .LVU129
 448              		.loc 1 171 13 is_stmt 0 view .LVU130
 449 001a 4379     		ldrb	r3, [r0, #5]	@ zero_extendqisi2
 450 001c 8DF80130 		strb	r3, [sp, #1]
 172:src/aes.c     ****     tmp[5]  = state[9];
 451              		.loc 1 172 5 is_stmt 1 view .LVU131
 452              		.loc 1 172 13 is_stmt 0 view .LVU132
 453 0020 437A     		ldrb	r3, [r0, #9]	@ zero_extendqisi2
 454 0022 8DF80530 		strb	r3, [sp, #5]
 173:src/aes.c     ****     tmp[9]  = state[13];
 455              		.loc 1 173 5 is_stmt 1 view .LVU133
 456              		.loc 1 173 13 is_stmt 0 view .LVU134
 457 0026 437B     		ldrb	r3, [r0, #13]	@ zero_extendqisi2
 458 0028 8DF80930 		strb	r3, [sp, #9]
 174:src/aes.c     ****     tmp[13] = state[1];
 459              		.loc 1 174 5 is_stmt 1 view .LVU135
 460              		.loc 1 174 13 is_stmt 0 view .LVU136
 461 002c 4378     		ldrb	r3, [r0, #1]	@ zero_extendqisi2
 462 002e 8DF80D30 		strb	r3, [sp, #13]
 175:src/aes.c     **** 
 176:src/aes.c     ****     // Row 2 (shift left by 2)
 177:src/aes.c     ****     tmp[2]  = state[10];
 463              		.loc 1 177 5 is_stmt 1 view .LVU137
 464              		.loc 1 177 13 is_stmt 0 view .LVU138
 465 0032 837A     		ldrb	r3, [r0, #10]	@ zero_extendqisi2
 466 0034 8DF80230 		strb	r3, [sp, #2]
 178:src/aes.c     ****     tmp[6]  = state[14];
 467              		.loc 1 178 5 is_stmt 1 view .LVU139
 468              		.loc 1 178 13 is_stmt 0 view .LVU140
 469 0038 837B     		ldrb	r3, [r0, #14]	@ zero_extendqisi2
 470 003a 8DF80630 		strb	r3, [sp, #6]
 179:src/aes.c     ****     tmp[10] = state[2];
 471              		.loc 1 179 5 is_stmt 1 view .LVU141
 472              		.loc 1 179 13 is_stmt 0 view .LVU142
 473 003e 8378     		ldrb	r3, [r0, #2]	@ zero_extendqisi2
 474 0040 8DF80A30 		strb	r3, [sp, #10]
 180:src/aes.c     ****     tmp[14] = state[6];
 475              		.loc 1 180 5 is_stmt 1 view .LVU143
 476              		.loc 1 180 13 is_stmt 0 view .LVU144
 477 0044 8379     		ldrb	r3, [r0, #6]	@ zero_extendqisi2
 478 0046 8DF80E30 		strb	r3, [sp, #14]
 181:src/aes.c     **** 
 182:src/aes.c     ****     // Row 3 (shift left by 3)
 183:src/aes.c     ****     tmp[3]  = state[15];
 479              		.loc 1 183 5 is_stmt 1 view .LVU145
 480              		.loc 1 183 13 is_stmt 0 view .LVU146
 481 004a C37B     		ldrb	r3, [r0, #15]	@ zero_extendqisi2
 482 004c 8DF80330 		strb	r3, [sp, #3]
 184:src/aes.c     ****     tmp[7]  = state[3];
 483              		.loc 1 184 5 is_stmt 1 view .LVU147
 484              		.loc 1 184 13 is_stmt 0 view .LVU148
 485 0050 C378     		ldrb	r3, [r0, #3]	@ zero_extendqisi2
 486 0052 8DF80730 		strb	r3, [sp, #7]
 185:src/aes.c     ****     tmp[11] = state[7];
 487              		.loc 1 185 5 is_stmt 1 view .LVU149
 488              		.loc 1 185 13 is_stmt 0 view .LVU150
 489 0056 C379     		ldrb	r3, [r0, #7]	@ zero_extendqisi2
ARM GAS  /tmp/ccwvKy3T.s 			page 13


 490 0058 8DF80B30 		strb	r3, [sp, #11]
 186:src/aes.c     ****     tmp[15] = state[11];
 491              		.loc 1 186 5 is_stmt 1 view .LVU151
 492              		.loc 1 186 13 is_stmt 0 view .LVU152
 493 005c C37A     		ldrb	r3, [r0, #11]	@ zero_extendqisi2
 494 005e 8DF80F30 		strb	r3, [sp, #15]
 187:src/aes.c     **** 
 188:src/aes.c     ****     // Copy back
 189:src/aes.c     ****     for (int i = 0; i < 16; i++)
 495              		.loc 1 189 5 is_stmt 1 view .LVU153
 496              	.LBB12:
 497              		.loc 1 189 10 view .LVU154
 498              	.LVL31:
 499              		.loc 1 189 14 is_stmt 0 view .LVU155
 500 0062 0023     		movs	r3, #0
 501              		.loc 1 189 5 view .LVU156
 502 0064 06E0     		b	.L30
 503              	.LVL32:
 504              	.L31:
 190:src/aes.c     ****     {
 191:src/aes.c     ****         state[i] = tmp[i];
 505              		.loc 1 191 9 is_stmt 1 discriminator 3 view .LVU157
 506              		.loc 1 191 23 is_stmt 0 discriminator 3 view .LVU158
 507 0066 03F11002 		add	r2, r3, #16
 508 006a 6A44     		add	r2, sp, r2
 509 006c 12F8102C 		ldrb	r2, [r2, #-16]	@ zero_extendqisi2
 510              		.loc 1 191 18 discriminator 3 view .LVU159
 511 0070 C254     		strb	r2, [r0, r3]
 189:src/aes.c     ****     {
 512              		.loc 1 189 29 is_stmt 1 discriminator 3 view .LVU160
 189:src/aes.c     ****     {
 513              		.loc 1 189 30 is_stmt 0 discriminator 3 view .LVU161
 514 0072 0133     		adds	r3, r3, #1
 515              	.LVL33:
 516              	.L30:
 189:src/aes.c     ****     {
 517              		.loc 1 189 21 is_stmt 1 discriminator 1 view .LVU162
 189:src/aes.c     ****     {
 518              		.loc 1 189 5 is_stmt 0 discriminator 1 view .LVU163
 519 0074 0F2B     		cmp	r3, #15
 520 0076 F6DD     		ble	.L31
 521              	.LBE12:
 192:src/aes.c     ****     } 
 193:src/aes.c     **** }
 522              		.loc 1 193 1 view .LVU164
 523 0078 04B0     		add	sp, sp, #16
 524              	.LCFI9:
 525              		.cfi_def_cfa_offset 0
 526              		@ sp needed
 527 007a 7047     		bx	lr
 528              		.cfi_endproc
 529              	.LFE139:
 531              		.section	.text.gfmul,"ax",%progbits
 532              		.align	1
 533              		.syntax unified
 534              		.thumb
 535              		.thumb_func
ARM GAS  /tmp/ccwvKy3T.s 			page 14


 536              		.fpu fpv4-sp-d16
 538              	gfmul:
 539              	.LVL34:
 540              	.LFB140:
 194:src/aes.c     **** 
 195:src/aes.c     **** /**
 196:src/aes.c     ****  * 
 197:src/aes.c     ****  */
 198:src/aes.c     **** static uint8_t gfmul(uint8_t a, uint8_t b) {
 541              		.loc 1 198 44 is_stmt 1 view -0
 542              		.cfi_startproc
 543              		@ args = 0, pretend = 0, frame = 0
 544              		@ frame_needed = 0, uses_anonymous_args = 0
 545              		@ link register save eliminated.
 546              		.loc 1 198 44 is_stmt 0 view .LVU166
 547 0000 0246     		mov	r2, r0
 199:src/aes.c     ****     uint8_t p = 0;
 548              		.loc 1 199 5 is_stmt 1 view .LVU167
 549              	.LVL35:
 200:src/aes.c     **** 
 201:src/aes.c     ****     for (int i = 0; i < 8; i++)
 550              		.loc 1 201 5 view .LVU168
 551              	.LBB13:
 552              		.loc 1 201 10 view .LVU169
 553              		.loc 1 201 14 is_stmt 0 view .LVU170
 554 0002 4FF0000C 		mov	ip, #0
 555              	.LBE13:
 199:src/aes.c     ****     uint8_t p = 0;
 556              		.loc 1 199 13 view .LVU171
 557 0006 6046     		mov	r0, ip
 558              	.LVL36:
 559              	.LBB16:
 560              		.loc 1 201 5 view .LVU172
 561 0008 08E0     		b	.L34
 562              	.LVL37:
 563              	.L35:
 564              	.LBB14:
 202:src/aes.c     ****     {
 203:src/aes.c     ****         if (b & 1) 
 204:src/aes.c     ****         {
 205:src/aes.c     ****             p ^= a;
 206:src/aes.c     ****         }
 207:src/aes.c     **** 
 208:src/aes.c     ****         uint8_t hi_bit_set = a & 0x80;
 565              		.loc 1 208 9 is_stmt 1 view .LVU173
 209:src/aes.c     ****         a <<= 1;
 566              		.loc 1 209 9 view .LVU174
 567              		.loc 1 209 11 is_stmt 0 view .LVU175
 568 000a 5300     		lsls	r3, r2, #1
 569 000c DBB2     		uxtb	r3, r3
 570              	.LVL38:
 210:src/aes.c     **** 
 211:src/aes.c     ****         if (hi_bit_set) 
 571              		.loc 1 211 9 is_stmt 1 view .LVU176
 572              		.loc 1 211 12 is_stmt 0 view .LVU177
 573 000e 12F0800F 		tst	r2, #128
 574 0012 0CD1     		bne	.L38
ARM GAS  /tmp/ccwvKy3T.s 			page 15


 575              	.L36:
 212:src/aes.c     ****         {
 213:src/aes.c     ****             a ^= 0x1b;    
 214:src/aes.c     ****         }
 215:src/aes.c     ****         b >>= 1;
 576              		.loc 1 215 9 is_stmt 1 discriminator 2 view .LVU178
 577              		.loc 1 215 11 is_stmt 0 discriminator 2 view .LVU179
 578 0014 4908     		lsrs	r1, r1, #1
 579              	.LVL39:
 580              		.loc 1 215 11 discriminator 2 view .LVU180
 581              	.LBE14:
 201:src/aes.c     ****     {
 582              		.loc 1 201 28 is_stmt 1 discriminator 2 view .LVU181
 201:src/aes.c     ****     {
 583              		.loc 1 201 29 is_stmt 0 discriminator 2 view .LVU182
 584 0016 0CF1010C 		add	ip, ip, #1
 585              	.LVL40:
 201:src/aes.c     ****     {
 586              		.loc 1 201 29 discriminator 2 view .LVU183
 587 001a 1A46     		mov	r2, r3
 588              	.LVL41:
 589              	.L34:
 201:src/aes.c     ****     {
 590              		.loc 1 201 21 is_stmt 1 discriminator 1 view .LVU184
 201:src/aes.c     ****     {
 591              		.loc 1 201 5 is_stmt 0 discriminator 1 view .LVU185
 592 001c BCF1070F 		cmp	ip, #7
 593 0020 08DC     		bgt	.L39
 594              	.LBB15:
 203:src/aes.c     ****         {
 595              		.loc 1 203 9 is_stmt 1 view .LVU186
 203:src/aes.c     ****         {
 596              		.loc 1 203 12 is_stmt 0 view .LVU187
 597 0022 11F0010F 		tst	r1, #1
 598 0026 F0D0     		beq	.L35
 205:src/aes.c     ****         }
 599              		.loc 1 205 13 is_stmt 1 view .LVU188
 205:src/aes.c     ****         }
 600              		.loc 1 205 15 is_stmt 0 view .LVU189
 601 0028 5040     		eors	r0, r0, r2
 602              	.LVL42:
 205:src/aes.c     ****         }
 603              		.loc 1 205 15 view .LVU190
 604 002a C0B2     		uxtb	r0, r0
 605              	.LVL43:
 205:src/aes.c     ****         }
 606              		.loc 1 205 15 view .LVU191
 607 002c EDE7     		b	.L35
 608              	.LVL44:
 609              	.L38:
 213:src/aes.c     ****         }
 610              		.loc 1 213 13 is_stmt 1 view .LVU192
 213:src/aes.c     ****         }
 611              		.loc 1 213 15 is_stmt 0 view .LVU193
 612 002e 83F01B03 		eor	r3, r3, #27
 613              	.LVL45:
 213:src/aes.c     ****         }
ARM GAS  /tmp/ccwvKy3T.s 			page 16


 614              		.loc 1 213 15 view .LVU194
 615 0032 EFE7     		b	.L36
 616              	.LVL46:
 617              	.L39:
 213:src/aes.c     ****         }
 618              		.loc 1 213 15 view .LVU195
 619              	.LBE15:
 620              	.LBE16:
 216:src/aes.c     ****     }
 217:src/aes.c     ****     return p;
 621              		.loc 1 217 5 is_stmt 1 view .LVU196
 218:src/aes.c     **** }
 622              		.loc 1 218 1 is_stmt 0 view .LVU197
 623 0034 7047     		bx	lr
 624              		.cfi_endproc
 625              	.LFE140:
 627              		.section	.text.mix_columns,"ax",%progbits
 628              		.align	1
 629              		.syntax unified
 630              		.thumb
 631              		.thumb_func
 632              		.fpu fpv4-sp-d16
 634              	mix_columns:
 635              	.LVL47:
 636              	.LFB141:
 219:src/aes.c     **** 
 220:src/aes.c     **** /**
 221:src/aes.c     ****  * 
 222:src/aes.c     ****  */
 223:src/aes.c     **** static void mix_columns(uint8_t* state)
 224:src/aes.c     **** {
 637              		.loc 1 224 1 is_stmt 1 view -0
 638              		.cfi_startproc
 639              		@ args = 0, pretend = 0, frame = 16
 640              		@ frame_needed = 0, uses_anonymous_args = 0
 641              		.loc 1 224 1 is_stmt 0 view .LVU199
 642 0000 2DE9F043 		push	{r4, r5, r6, r7, r8, r9, lr}
 643              	.LCFI10:
 644              		.cfi_def_cfa_offset 28
 645              		.cfi_offset 4, -28
 646              		.cfi_offset 5, -24
 647              		.cfi_offset 6, -20
 648              		.cfi_offset 7, -16
 649              		.cfi_offset 8, -12
 650              		.cfi_offset 9, -8
 651              		.cfi_offset 14, -4
 652 0004 85B0     		sub	sp, sp, #20
 653              	.LCFI11:
 654              		.cfi_def_cfa_offset 48
 655 0006 0746     		mov	r7, r0
 225:src/aes.c     ****     uint8_t tmp[16];
 656              		.loc 1 225 5 is_stmt 1 view .LVU200
 226:src/aes.c     **** 
 227:src/aes.c     ****     for (int i = 0; i < 4; i++)
 657              		.loc 1 227 5 view .LVU201
 658              	.LBB17:
 659              		.loc 1 227 10 view .LVU202
ARM GAS  /tmp/ccwvKy3T.s 			page 17


 660              	.LVL48:
 661              		.loc 1 227 14 is_stmt 0 view .LVU203
 662 0008 4FF00009 		mov	r9, #0
 663              		.loc 1 227 5 view .LVU204
 664 000c 23E0     		b	.L41
 665              	.LVL49:
 666              	.L43:
 667              	.LBB18:
 668              	.LBB19:
 228:src/aes.c     ****     {
 229:src/aes.c     ****         for (int j = 0; j < 4; j++)
 230:src/aes.c     ****         {
 231:src/aes.c     ****             tmp[i * 4 + j] = 0;
 232:src/aes.c     **** 
 233:src/aes.c     ****             for (int k = 0; k < 4; k++)
 234:src/aes.c     ****             {
 235:src/aes.c     ****                 tmp[i * 4 + j] ^= gfmul(mix_col[j * 4 + k], state[i * 4 + k]);
 669              		.loc 1 235 17 is_stmt 1 discriminator 3 view .LVU205
 670              		.loc 1 235 55 is_stmt 0 discriminator 3 view .LVU206
 671 000e 04EB8503 		add	r3, r4, r5, lsl #2
 672              		.loc 1 235 73 discriminator 3 view .LVU207
 673 0012 08EB0402 		add	r2, r8, r4
 674              		.loc 1 235 35 discriminator 3 view .LVU208
 675 0016 B95C     		ldrb	r1, [r7, r2]	@ zero_extendqisi2
 676 0018 184A     		ldr	r2, .L52
 677 001a D05C     		ldrb	r0, [r2, r3]	@ zero_extendqisi2
 678 001c FFF7FEFF 		bl	gfmul
 679              	.LVL50:
 680              		.loc 1 235 32 discriminator 3 view .LVU209
 681 0020 06F11003 		add	r3, r6, #16
 682 0024 6B44     		add	r3, sp, r3
 683 0026 13F8102C 		ldrb	r2, [r3, #-16]	@ zero_extendqisi2
 684 002a 5040     		eors	r0, r0, r2
 685 002c 03F8100C 		strb	r0, [r3, #-16]
 233:src/aes.c     ****             {
 686              		.loc 1 233 36 is_stmt 1 discriminator 3 view .LVU210
 233:src/aes.c     ****             {
 687              		.loc 1 233 37 is_stmt 0 discriminator 3 view .LVU211
 688 0030 0134     		adds	r4, r4, #1
 689              	.LVL51:
 690              	.L42:
 233:src/aes.c     ****             {
 691              		.loc 1 233 29 is_stmt 1 discriminator 1 view .LVU212
 233:src/aes.c     ****             {
 692              		.loc 1 233 13 is_stmt 0 discriminator 1 view .LVU213
 693 0032 032C     		cmp	r4, #3
 694 0034 EBDD     		ble	.L43
 695              	.LBE19:
 229:src/aes.c     ****         {
 696              		.loc 1 229 32 is_stmt 1 discriminator 2 view .LVU214
 229:src/aes.c     ****         {
 697              		.loc 1 229 33 is_stmt 0 discriminator 2 view .LVU215
 698 0036 0135     		adds	r5, r5, #1
 699              	.LVL52:
 700              	.L45:
 229:src/aes.c     ****         {
 701              		.loc 1 229 25 is_stmt 1 discriminator 1 view .LVU216
ARM GAS  /tmp/ccwvKy3T.s 			page 18


 229:src/aes.c     ****         {
 702              		.loc 1 229 9 is_stmt 0 discriminator 1 view .LVU217
 703 0038 032D     		cmp	r5, #3
 704 003a 0ADC     		bgt	.L50
 231:src/aes.c     **** 
 705              		.loc 1 231 13 is_stmt 1 view .LVU218
 231:src/aes.c     **** 
 706              		.loc 1 231 19 is_stmt 0 view .LVU219
 707 003c 4FEA8908 		lsl	r8, r9, #2
 231:src/aes.c     **** 
 708              		.loc 1 231 23 view .LVU220
 709 0040 05EB8906 		add	r6, r5, r9, lsl #2
 231:src/aes.c     **** 
 710              		.loc 1 231 28 view .LVU221
 711 0044 06F11003 		add	r3, r6, #16
 712 0048 6B44     		add	r3, sp, r3
 713 004a 0024     		movs	r4, #0
 714 004c 03F8104C 		strb	r4, [r3, #-16]
 233:src/aes.c     ****             {
 715              		.loc 1 233 13 is_stmt 1 view .LVU222
 716              	.LBB20:
 233:src/aes.c     ****             {
 717              		.loc 1 233 18 view .LVU223
 718              	.LVL53:
 233:src/aes.c     ****             {
 719              		.loc 1 233 13 is_stmt 0 view .LVU224
 720 0050 EFE7     		b	.L42
 721              	.LVL54:
 722              	.L50:
 233:src/aes.c     ****             {
 723              		.loc 1 233 13 view .LVU225
 724              	.LBE20:
 725              	.LBE18:
 227:src/aes.c     ****     {
 726              		.loc 1 227 28 is_stmt 1 discriminator 2 view .LVU226
 227:src/aes.c     ****     {
 727              		.loc 1 227 29 is_stmt 0 discriminator 2 view .LVU227
 728 0052 09F10109 		add	r9, r9, #1
 729              	.LVL55:
 730              	.L41:
 227:src/aes.c     ****     {
 731              		.loc 1 227 21 is_stmt 1 discriminator 1 view .LVU228
 227:src/aes.c     ****     {
 732              		.loc 1 227 5 is_stmt 0 discriminator 1 view .LVU229
 733 0056 B9F1030F 		cmp	r9, #3
 734 005a 01DC     		bgt	.L51
 735              	.LBB21:
 229:src/aes.c     ****         {
 736              		.loc 1 229 18 view .LVU230
 737 005c 0025     		movs	r5, #0
 738 005e EBE7     		b	.L45
 739              	.L51:
 740              	.LBE21:
 741              	.LBE17:
 742              	.LBB22:
 236:src/aes.c     ****             }
 237:src/aes.c     ****         }
ARM GAS  /tmp/ccwvKy3T.s 			page 19


 238:src/aes.c     ****     }
 239:src/aes.c     **** 
 240:src/aes.c     ****     // Copy back to base
 241:src/aes.c     ****     for (int i = 0; i < 16; ++i)
 743              		.loc 1 241 14 view .LVU231
 744 0060 0023     		movs	r3, #0
 745 0062 06E0     		b	.L46
 746              	.LVL56:
 747              	.L47:
 242:src/aes.c     ****     {
 243:src/aes.c     ****         state[i] = tmp[i];
 748              		.loc 1 243 9 is_stmt 1 discriminator 3 view .LVU232
 749              		.loc 1 243 23 is_stmt 0 discriminator 3 view .LVU233
 750 0064 03F11002 		add	r2, r3, #16
 751 0068 6A44     		add	r2, sp, r2
 752 006a 12F8102C 		ldrb	r2, [r2, #-16]	@ zero_extendqisi2
 753              		.loc 1 243 18 discriminator 3 view .LVU234
 754 006e FA54     		strb	r2, [r7, r3]
 241:src/aes.c     ****     {
 755              		.loc 1 241 29 is_stmt 1 discriminator 3 view .LVU235
 756 0070 0133     		adds	r3, r3, #1
 757              	.LVL57:
 758              	.L46:
 241:src/aes.c     ****     {
 759              		.loc 1 241 21 discriminator 1 view .LVU236
 241:src/aes.c     ****     {
 760              		.loc 1 241 5 is_stmt 0 discriminator 1 view .LVU237
 761 0072 0F2B     		cmp	r3, #15
 762 0074 F6DD     		ble	.L47
 763              	.LBE22:
 244:src/aes.c     ****     }
 245:src/aes.c     **** }
 764              		.loc 1 245 1 view .LVU238
 765 0076 05B0     		add	sp, sp, #20
 766              	.LCFI12:
 767              		.cfi_def_cfa_offset 28
 768              		@ sp needed
 769 0078 BDE8F083 		pop	{r4, r5, r6, r7, r8, r9, pc}
 770              	.LVL58:
 771              	.L53:
 772              		.loc 1 245 1 view .LVU239
 773              		.align	2
 774              	.L52:
 775 007c 00000000 		.word	.LANCHOR3
 776              		.cfi_endproc
 777              	.LFE141:
 779              		.section	.text.inv_sub_bytes,"ax",%progbits
 780              		.align	1
 781              		.syntax unified
 782              		.thumb
 783              		.thumb_func
 784              		.fpu fpv4-sp-d16
 786              	inv_sub_bytes:
 787              	.LVL59:
 788              	.LFB143:
 246:src/aes.c     **** 
 247:src/aes.c     **** /**
ARM GAS  /tmp/ccwvKy3T.s 			page 20


 248:src/aes.c     ****  * 
 249:src/aes.c     ****  */
 250:src/aes.c     **** uint8_t* aes_encryption(uint8_t* plain_text)
 251:src/aes.c     **** {
 252:src/aes.c     ****     for (int i=0; i<16; i++)
 253:src/aes.c     ****     {
 254:src/aes.c     ****         cipher_text[i] = plain_text[i];
 255:src/aes.c     ****     }
 256:src/aes.c     ****     
 257:src/aes.c     ****     add_round_key(cipher_text, 0);
 258:src/aes.c     **** 
 259:src/aes.c     ****     for (int i=1; i<10; i++)
 260:src/aes.c     ****     {
 261:src/aes.c     ****         sub_bytes(cipher_text, 16);
 262:src/aes.c     ****         shift_rows(cipher_text);
 263:src/aes.c     ****         mix_columns(cipher_text);
 264:src/aes.c     ****         add_round_key(cipher_text, i);
 265:src/aes.c     ****     }
 266:src/aes.c     **** 
 267:src/aes.c     ****     sub_bytes(cipher_text, 16);
 268:src/aes.c     ****     shift_rows(cipher_text);
 269:src/aes.c     ****     add_round_key(cipher_text, 10);
 270:src/aes.c     **** 
 271:src/aes.c     ****     return cipher_text;
 272:src/aes.c     **** }
 273:src/aes.c     **** 
 274:src/aes.c     **** /*---------------------------------------------------------------------------------------------*/
 275:src/aes.c     **** 
 276:src/aes.c     **** /**
 277:src/aes.c     ****  * 
 278:src/aes.c     ****  */
 279:src/aes.c     **** static void inv_sub_bytes(uint8_t* state, uint8_t size)
 280:src/aes.c     **** {
 789              		.loc 1 280 1 is_stmt 1 view -0
 790              		.cfi_startproc
 791              		@ args = 0, pretend = 0, frame = 0
 792              		@ frame_needed = 0, uses_anonymous_args = 0
 793              		@ link register save eliminated.
 281:src/aes.c     ****     for (int i=0; i<size; i++)
 794              		.loc 1 281 5 view .LVU241
 795              	.LBB23:
 796              		.loc 1 281 10 view .LVU242
 797              		.loc 1 281 14 is_stmt 0 view .LVU243
 798 0000 0023     		movs	r3, #0
 799              	.LVL60:
 800              		.loc 1 281 19 is_stmt 1 view .LVU244
 801              		.loc 1 281 5 is_stmt 0 view .LVU245
 802 0002 9942     		cmp	r1, r3
 803 0004 0FDD     		ble	.L60
 804              	.LBE23:
 280:src/aes.c     ****     for (int i=0; i<size; i++)
 805              		.loc 1 280 1 view .LVU246
 806 0006 10B4     		push	{r4}
 807              	.LCFI13:
 808              		.cfi_def_cfa_offset 4
 809              		.cfi_offset 4, -4
 810              	.L56:
ARM GAS  /tmp/ccwvKy3T.s 			page 21


 811              	.LBB25:
 812              	.LBB24:
 282:src/aes.c     ****     {
 283:src/aes.c     ****         uint8_t upper_nibble = (state[i] >> 4) & 0xF;
 813              		.loc 1 283 9 is_stmt 1 discriminator 3 view .LVU247
 814              		.loc 1 283 38 is_stmt 0 discriminator 3 view .LVU248
 815 0008 C25C     		ldrb	r2, [r0, r3]	@ zero_extendqisi2
 816              	.LVL61:
 284:src/aes.c     ****         uint8_t lower_nibble = state[i] & 0xF;
 817              		.loc 1 284 9 is_stmt 1 discriminator 3 view .LVU249
 818              		.loc 1 284 17 is_stmt 0 discriminator 3 view .LVU250
 819 000a 02F00F0C 		and	ip, r2, #15
 820              	.LVL62:
 285:src/aes.c     **** 
 286:src/aes.c     ****         state[i] = inv_s_box[(upper_nibble*16) + lower_nibble];
 821              		.loc 1 286 9 is_stmt 1 discriminator 3 view .LVU251
 822              		.loc 1 286 43 is_stmt 0 discriminator 3 view .LVU252
 823 000e 02F0F002 		and	r2, r2, #240
 824              	.LVL63:
 825              		.loc 1 286 48 discriminator 3 view .LVU253
 826 0012 6244     		add	r2, r2, ip
 827              		.loc 1 286 29 discriminator 3 view .LVU254
 828 0014 044C     		ldr	r4, .L61
 829 0016 A25C     		ldrb	r2, [r4, r2]	@ zero_extendqisi2
 830              		.loc 1 286 18 discriminator 3 view .LVU255
 831 0018 C254     		strb	r2, [r0, r3]
 832              	.LVL64:
 833              		.loc 1 286 18 discriminator 3 view .LVU256
 834              	.LBE24:
 281:src/aes.c     ****     {
 835              		.loc 1 281 27 is_stmt 1 discriminator 3 view .LVU257
 281:src/aes.c     ****     {
 836              		.loc 1 281 28 is_stmt 0 discriminator 3 view .LVU258
 837 001a 0133     		adds	r3, r3, #1
 838              	.LVL65:
 281:src/aes.c     ****     {
 839              		.loc 1 281 19 is_stmt 1 discriminator 3 view .LVU259
 281:src/aes.c     ****     {
 840              		.loc 1 281 5 is_stmt 0 discriminator 3 view .LVU260
 841 001c 9942     		cmp	r1, r3
 842 001e F3DC     		bgt	.L56
 843              	.LBE25:
 287:src/aes.c     ****     }
 288:src/aes.c     **** }
 844              		.loc 1 288 1 view .LVU261
 845 0020 5DF8044B 		ldr	r4, [sp], #4
 846              	.LCFI14:
 847              		.cfi_restore 4
 848              		.cfi_def_cfa_offset 0
 849 0024 7047     		bx	lr
 850              	.LVL66:
 851              	.L60:
 852              		.loc 1 288 1 view .LVU262
 853 0026 7047     		bx	lr
 854              	.L62:
 855              		.align	2
 856              	.L61:
ARM GAS  /tmp/ccwvKy3T.s 			page 22


 857 0028 00000000 		.word	.LANCHOR4
 858              		.cfi_endproc
 859              	.LFE143:
 861              		.section	.text.inv_shift_rows,"ax",%progbits
 862              		.align	1
 863              		.syntax unified
 864              		.thumb
 865              		.thumb_func
 866              		.fpu fpv4-sp-d16
 868              	inv_shift_rows:
 869              	.LVL67:
 870              	.LFB144:
 289:src/aes.c     **** 
 290:src/aes.c     **** /**
 291:src/aes.c     ****  * 
 292:src/aes.c     ****  */
 293:src/aes.c     **** static void inv_shift_rows(uint8_t* state)
 294:src/aes.c     **** {
 871              		.loc 1 294 1 is_stmt 1 view -0
 872              		.cfi_startproc
 873              		@ args = 0, pretend = 0, frame = 16
 874              		@ frame_needed = 0, uses_anonymous_args = 0
 875              		@ link register save eliminated.
 876              		.loc 1 294 1 is_stmt 0 view .LVU264
 877 0000 84B0     		sub	sp, sp, #16
 878              	.LCFI15:
 879              		.cfi_def_cfa_offset 16
 295:src/aes.c     ****     uint8_t tmp[16];
 880              		.loc 1 295 5 is_stmt 1 view .LVU265
 296:src/aes.c     **** 
 297:src/aes.c     ****     // Row 0 (no shift)
 298:src/aes.c     ****     tmp[0]  = state[0];
 881              		.loc 1 298 5 view .LVU266
 882              		.loc 1 298 20 is_stmt 0 view .LVU267
 883 0002 0378     		ldrb	r3, [r0]	@ zero_extendqisi2
 884              		.loc 1 298 13 view .LVU268
 885 0004 8DF80030 		strb	r3, [sp]
 299:src/aes.c     ****     tmp[4]  = state[4];
 886              		.loc 1 299 5 is_stmt 1 view .LVU269
 887              		.loc 1 299 13 is_stmt 0 view .LVU270
 888 0008 0379     		ldrb	r3, [r0, #4]	@ zero_extendqisi2
 889 000a 8DF80430 		strb	r3, [sp, #4]
 300:src/aes.c     ****     tmp[8]  = state[8];
 890              		.loc 1 300 5 is_stmt 1 view .LVU271
 891              		.loc 1 300 13 is_stmt 0 view .LVU272
 892 000e 037A     		ldrb	r3, [r0, #8]	@ zero_extendqisi2
 893 0010 8DF80830 		strb	r3, [sp, #8]
 301:src/aes.c     ****     tmp[12] = state[12];
 894              		.loc 1 301 5 is_stmt 1 view .LVU273
 895              		.loc 1 301 13 is_stmt 0 view .LVU274
 896 0014 037B     		ldrb	r3, [r0, #12]	@ zero_extendqisi2
 897 0016 8DF80C30 		strb	r3, [sp, #12]
 302:src/aes.c     **** 
 303:src/aes.c     ****     // Row 1 (shift right by 1)
 304:src/aes.c     ****     tmp[1]  = state[13];
 898              		.loc 1 304 5 is_stmt 1 view .LVU275
 899              		.loc 1 304 13 is_stmt 0 view .LVU276
ARM GAS  /tmp/ccwvKy3T.s 			page 23


 900 001a 437B     		ldrb	r3, [r0, #13]	@ zero_extendqisi2
 901 001c 8DF80130 		strb	r3, [sp, #1]
 305:src/aes.c     ****     tmp[5]  = state[1];
 902              		.loc 1 305 5 is_stmt 1 view .LVU277
 903              		.loc 1 305 13 is_stmt 0 view .LVU278
 904 0020 4378     		ldrb	r3, [r0, #1]	@ zero_extendqisi2
 905 0022 8DF80530 		strb	r3, [sp, #5]
 306:src/aes.c     ****     tmp[9]  = state[5];
 906              		.loc 1 306 5 is_stmt 1 view .LVU279
 907              		.loc 1 306 13 is_stmt 0 view .LVU280
 908 0026 4379     		ldrb	r3, [r0, #5]	@ zero_extendqisi2
 909 0028 8DF80930 		strb	r3, [sp, #9]
 307:src/aes.c     ****     tmp[13] = state[9];
 910              		.loc 1 307 5 is_stmt 1 view .LVU281
 911              		.loc 1 307 13 is_stmt 0 view .LVU282
 912 002c 437A     		ldrb	r3, [r0, #9]	@ zero_extendqisi2
 913 002e 8DF80D30 		strb	r3, [sp, #13]
 308:src/aes.c     **** 
 309:src/aes.c     ****     // Row 2 (shift right by 2)
 310:src/aes.c     ****     tmp[2]  = state[10];
 914              		.loc 1 310 5 is_stmt 1 view .LVU283
 915              		.loc 1 310 13 is_stmt 0 view .LVU284
 916 0032 837A     		ldrb	r3, [r0, #10]	@ zero_extendqisi2
 917 0034 8DF80230 		strb	r3, [sp, #2]
 311:src/aes.c     ****     tmp[6]  = state[14];
 918              		.loc 1 311 5 is_stmt 1 view .LVU285
 919              		.loc 1 311 13 is_stmt 0 view .LVU286
 920 0038 837B     		ldrb	r3, [r0, #14]	@ zero_extendqisi2
 921 003a 8DF80630 		strb	r3, [sp, #6]
 312:src/aes.c     ****     tmp[10] = state[2];
 922              		.loc 1 312 5 is_stmt 1 view .LVU287
 923              		.loc 1 312 13 is_stmt 0 view .LVU288
 924 003e 8378     		ldrb	r3, [r0, #2]	@ zero_extendqisi2
 925 0040 8DF80A30 		strb	r3, [sp, #10]
 313:src/aes.c     ****     tmp[14] = state[6];
 926              		.loc 1 313 5 is_stmt 1 view .LVU289
 927              		.loc 1 313 13 is_stmt 0 view .LVU290
 928 0044 8379     		ldrb	r3, [r0, #6]	@ zero_extendqisi2
 929 0046 8DF80E30 		strb	r3, [sp, #14]
 314:src/aes.c     **** 
 315:src/aes.c     ****     // Row 3 (shift right by 3)
 316:src/aes.c     ****     tmp[3]  = state[7];
 930              		.loc 1 316 5 is_stmt 1 view .LVU291
 931              		.loc 1 316 13 is_stmt 0 view .LVU292
 932 004a C379     		ldrb	r3, [r0, #7]	@ zero_extendqisi2
 933 004c 8DF80330 		strb	r3, [sp, #3]
 317:src/aes.c     ****     tmp[7]  = state[11];
 934              		.loc 1 317 5 is_stmt 1 view .LVU293
 935              		.loc 1 317 13 is_stmt 0 view .LVU294
 936 0050 C37A     		ldrb	r3, [r0, #11]	@ zero_extendqisi2
 937 0052 8DF80730 		strb	r3, [sp, #7]
 318:src/aes.c     ****     tmp[11] = state[15];
 938              		.loc 1 318 5 is_stmt 1 view .LVU295
 939              		.loc 1 318 13 is_stmt 0 view .LVU296
 940 0056 C37B     		ldrb	r3, [r0, #15]	@ zero_extendqisi2
 941 0058 8DF80B30 		strb	r3, [sp, #11]
 319:src/aes.c     ****     tmp[15] = state[3];
ARM GAS  /tmp/ccwvKy3T.s 			page 24


 942              		.loc 1 319 5 is_stmt 1 view .LVU297
 943              		.loc 1 319 13 is_stmt 0 view .LVU298
 944 005c C378     		ldrb	r3, [r0, #3]	@ zero_extendqisi2
 945 005e 8DF80F30 		strb	r3, [sp, #15]
 320:src/aes.c     **** 
 321:src/aes.c     ****     // Copy back
 322:src/aes.c     ****     for (int i = 0; i < 16; i++)
 946              		.loc 1 322 5 is_stmt 1 view .LVU299
 947              	.LBB26:
 948              		.loc 1 322 10 view .LVU300
 949              	.LVL68:
 950              		.loc 1 322 14 is_stmt 0 view .LVU301
 951 0062 0023     		movs	r3, #0
 952              		.loc 1 322 5 view .LVU302
 953 0064 06E0     		b	.L64
 954              	.LVL69:
 955              	.L65:
 323:src/aes.c     ****     {
 324:src/aes.c     ****         state[i] = tmp[i];
 956              		.loc 1 324 9 is_stmt 1 discriminator 3 view .LVU303
 957              		.loc 1 324 23 is_stmt 0 discriminator 3 view .LVU304
 958 0066 03F11002 		add	r2, r3, #16
 959 006a 6A44     		add	r2, sp, r2
 960 006c 12F8102C 		ldrb	r2, [r2, #-16]	@ zero_extendqisi2
 961              		.loc 1 324 18 discriminator 3 view .LVU305
 962 0070 C254     		strb	r2, [r0, r3]
 322:src/aes.c     ****     {
 963              		.loc 1 322 29 is_stmt 1 discriminator 3 view .LVU306
 322:src/aes.c     ****     {
 964              		.loc 1 322 30 is_stmt 0 discriminator 3 view .LVU307
 965 0072 0133     		adds	r3, r3, #1
 966              	.LVL70:
 967              	.L64:
 322:src/aes.c     ****     {
 968              		.loc 1 322 21 is_stmt 1 discriminator 1 view .LVU308
 322:src/aes.c     ****     {
 969              		.loc 1 322 5 is_stmt 0 discriminator 1 view .LVU309
 970 0074 0F2B     		cmp	r3, #15
 971 0076 F6DD     		ble	.L65
 972              	.LBE26:
 325:src/aes.c     ****     } 
 326:src/aes.c     **** }
 973              		.loc 1 326 1 view .LVU310
 974 0078 04B0     		add	sp, sp, #16
 975              	.LCFI16:
 976              		.cfi_def_cfa_offset 0
 977              		@ sp needed
 978 007a 7047     		bx	lr
 979              		.cfi_endproc
 980              	.LFE144:
 982              		.section	.text.inv_mix_columns,"ax",%progbits
 983              		.align	1
 984              		.syntax unified
 985              		.thumb
 986              		.thumb_func
 987              		.fpu fpv4-sp-d16
 989              	inv_mix_columns:
ARM GAS  /tmp/ccwvKy3T.s 			page 25


 990              	.LVL71:
 991              	.LFB145:
 327:src/aes.c     **** 
 328:src/aes.c     **** /**
 329:src/aes.c     ****  * 
 330:src/aes.c     ****  */
 331:src/aes.c     **** static void inv_mix_columns(uint8_t* state)
 332:src/aes.c     **** {
 992              		.loc 1 332 1 is_stmt 1 view -0
 993              		.cfi_startproc
 994              		@ args = 0, pretend = 0, frame = 16
 995              		@ frame_needed = 0, uses_anonymous_args = 0
 996              		.loc 1 332 1 is_stmt 0 view .LVU312
 997 0000 2DE9F043 		push	{r4, r5, r6, r7, r8, r9, lr}
 998              	.LCFI17:
 999              		.cfi_def_cfa_offset 28
 1000              		.cfi_offset 4, -28
 1001              		.cfi_offset 5, -24
 1002              		.cfi_offset 6, -20
 1003              		.cfi_offset 7, -16
 1004              		.cfi_offset 8, -12
 1005              		.cfi_offset 9, -8
 1006              		.cfi_offset 14, -4
 1007 0004 85B0     		sub	sp, sp, #20
 1008              	.LCFI18:
 1009              		.cfi_def_cfa_offset 48
 1010 0006 0746     		mov	r7, r0
 333:src/aes.c     ****     uint8_t temp[16];
 1011              		.loc 1 333 5 is_stmt 1 view .LVU313
 334:src/aes.c     **** 
 335:src/aes.c     ****     for (int col = 0; col < 4; ++col)
 1012              		.loc 1 335 5 view .LVU314
 1013              	.LBB27:
 1014              		.loc 1 335 10 view .LVU315
 1015              	.LVL72:
 1016              		.loc 1 335 14 is_stmt 0 view .LVU316
 1017 0008 4FF00009 		mov	r9, #0
 1018              		.loc 1 335 5 view .LVU317
 1019 000c 23E0     		b	.L68
 1020              	.LVL73:
 1021              	.L70:
 1022              	.LBB28:
 1023              	.LBB29:
 336:src/aes.c     ****     {
 337:src/aes.c     ****         for (int row = 0; row < 4; ++row)
 338:src/aes.c     ****         {
 339:src/aes.c     ****             temp[col * 4 + row] = 0;
 340:src/aes.c     ****             for (int k = 0; k < 4; ++k)
 341:src/aes.c     ****             {
 342:src/aes.c     ****                 temp[col * 4 + row] ^= gfmul(inv_mix_col[row * 4 + k], state[col * 4 + k]);
 1024              		.loc 1 342 17 is_stmt 1 discriminator 3 view .LVU318
 1025              		.loc 1 342 66 is_stmt 0 discriminator 3 view .LVU319
 1026 000e 04EB8503 		add	r3, r4, r5, lsl #2
 1027              		.loc 1 342 86 discriminator 3 view .LVU320
 1028 0012 08EB0402 		add	r2, r8, r4
 1029              		.loc 1 342 40 discriminator 3 view .LVU321
 1030 0016 B95C     		ldrb	r1, [r7, r2]	@ zero_extendqisi2
ARM GAS  /tmp/ccwvKy3T.s 			page 26


 1031 0018 184A     		ldr	r2, .L79
 1032 001a D05C     		ldrb	r0, [r2, r3]	@ zero_extendqisi2
 1033 001c FFF7FEFF 		bl	gfmul
 1034              	.LVL74:
 1035              		.loc 1 342 37 discriminator 3 view .LVU322
 1036 0020 06F11003 		add	r3, r6, #16
 1037 0024 6B44     		add	r3, sp, r3
 1038 0026 13F8102C 		ldrb	r2, [r3, #-16]	@ zero_extendqisi2
 1039 002a 5040     		eors	r0, r0, r2
 1040 002c 03F8100C 		strb	r0, [r3, #-16]
 340:src/aes.c     ****             {
 1041              		.loc 1 340 36 is_stmt 1 discriminator 3 view .LVU323
 1042 0030 0134     		adds	r4, r4, #1
 1043              	.LVL75:
 1044              	.L69:
 340:src/aes.c     ****             {
 1045              		.loc 1 340 29 discriminator 1 view .LVU324
 340:src/aes.c     ****             {
 1046              		.loc 1 340 13 is_stmt 0 discriminator 1 view .LVU325
 1047 0032 032C     		cmp	r4, #3
 1048 0034 EBDD     		ble	.L70
 1049              	.LBE29:
 337:src/aes.c     ****         {
 1050              		.loc 1 337 36 is_stmt 1 discriminator 2 view .LVU326
 1051 0036 0135     		adds	r5, r5, #1
 1052              	.LVL76:
 1053              	.L72:
 337:src/aes.c     ****         {
 1054              		.loc 1 337 27 discriminator 1 view .LVU327
 337:src/aes.c     ****         {
 1055              		.loc 1 337 9 is_stmt 0 discriminator 1 view .LVU328
 1056 0038 032D     		cmp	r5, #3
 1057 003a 0ADC     		bgt	.L77
 339:src/aes.c     ****             for (int k = 0; k < 4; ++k)
 1058              		.loc 1 339 13 is_stmt 1 view .LVU329
 339:src/aes.c     ****             for (int k = 0; k < 4; ++k)
 1059              		.loc 1 339 22 is_stmt 0 view .LVU330
 1060 003c 4FEA8908 		lsl	r8, r9, #2
 339:src/aes.c     ****             for (int k = 0; k < 4; ++k)
 1061              		.loc 1 339 26 view .LVU331
 1062 0040 05EB8906 		add	r6, r5, r9, lsl #2
 339:src/aes.c     ****             for (int k = 0; k < 4; ++k)
 1063              		.loc 1 339 33 view .LVU332
 1064 0044 06F11003 		add	r3, r6, #16
 1065 0048 6B44     		add	r3, sp, r3
 1066 004a 0024     		movs	r4, #0
 1067 004c 03F8104C 		strb	r4, [r3, #-16]
 340:src/aes.c     ****             {
 1068              		.loc 1 340 13 is_stmt 1 view .LVU333
 1069              	.LBB30:
 340:src/aes.c     ****             {
 1070              		.loc 1 340 18 view .LVU334
 1071              	.LVL77:
 340:src/aes.c     ****             {
 1072              		.loc 1 340 13 is_stmt 0 view .LVU335
 1073 0050 EFE7     		b	.L69
 1074              	.LVL78:
ARM GAS  /tmp/ccwvKy3T.s 			page 27


 1075              	.L77:
 340:src/aes.c     ****             {
 1076              		.loc 1 340 13 view .LVU336
 1077              	.LBE30:
 1078              	.LBE28:
 335:src/aes.c     ****     {
 1079              		.loc 1 335 32 is_stmt 1 discriminator 2 view .LVU337
 1080 0052 09F10109 		add	r9, r9, #1
 1081              	.LVL79:
 1082              	.L68:
 335:src/aes.c     ****     {
 1083              		.loc 1 335 23 discriminator 1 view .LVU338
 335:src/aes.c     ****     {
 1084              		.loc 1 335 5 is_stmt 0 discriminator 1 view .LVU339
 1085 0056 B9F1030F 		cmp	r9, #3
 1086 005a 01DC     		bgt	.L78
 1087              	.LBB31:
 337:src/aes.c     ****         {
 1088              		.loc 1 337 18 view .LVU340
 1089 005c 0025     		movs	r5, #0
 1090 005e EBE7     		b	.L72
 1091              	.L78:
 1092              	.LBE31:
 1093              	.LBE27:
 1094              	.LBB32:
 343:src/aes.c     ****             }
 344:src/aes.c     ****         }
 345:src/aes.c     ****     }
 346:src/aes.c     ****     // Copy back to base
 347:src/aes.c     ****     for (int i = 0; i < 16; ++i)
 1095              		.loc 1 347 14 view .LVU341
 1096 0060 0023     		movs	r3, #0
 1097 0062 06E0     		b	.L73
 1098              	.LVL80:
 1099              	.L74:
 348:src/aes.c     ****     {
 349:src/aes.c     ****         state[i] = temp[i];
 1100              		.loc 1 349 9 is_stmt 1 discriminator 3 view .LVU342
 1101              		.loc 1 349 24 is_stmt 0 discriminator 3 view .LVU343
 1102 0064 03F11002 		add	r2, r3, #16
 1103 0068 6A44     		add	r2, sp, r2
 1104 006a 12F8102C 		ldrb	r2, [r2, #-16]	@ zero_extendqisi2
 1105              		.loc 1 349 18 discriminator 3 view .LVU344
 1106 006e FA54     		strb	r2, [r7, r3]
 347:src/aes.c     ****     {
 1107              		.loc 1 347 29 is_stmt 1 discriminator 3 view .LVU345
 1108 0070 0133     		adds	r3, r3, #1
 1109              	.LVL81:
 1110              	.L73:
 347:src/aes.c     ****     {
 1111              		.loc 1 347 21 discriminator 1 view .LVU346
 347:src/aes.c     ****     {
 1112              		.loc 1 347 5 is_stmt 0 discriminator 1 view .LVU347
 1113 0072 0F2B     		cmp	r3, #15
 1114 0074 F6DD     		ble	.L74
 1115              	.LBE32:
 350:src/aes.c     ****     }
ARM GAS  /tmp/ccwvKy3T.s 			page 28


 351:src/aes.c     **** }
 1116              		.loc 1 351 1 view .LVU348
 1117 0076 05B0     		add	sp, sp, #20
 1118              	.LCFI19:
 1119              		.cfi_def_cfa_offset 28
 1120              		@ sp needed
 1121 0078 BDE8F083 		pop	{r4, r5, r6, r7, r8, r9, pc}
 1122              	.LVL82:
 1123              	.L80:
 1124              		.loc 1 351 1 view .LVU349
 1125              		.align	2
 1126              	.L79:
 1127 007c 00000000 		.word	.LANCHOR5
 1128              		.cfi_endproc
 1129              	.LFE145:
 1131              		.section	.text.aes_init,"ax",%progbits
 1132              		.align	1
 1133              		.global	aes_init
 1134              		.syntax unified
 1135              		.thumb
 1136              		.thumb_func
 1137              		.fpu fpv4-sp-d16
 1139              	aes_init:
 1140              	.LFB137:
 120:src/aes.c     ****     // Check key length
 1141              		.loc 1 120 1 is_stmt 1 view -0
 1142              		.cfi_startproc
 1143              		@ args = 0, pretend = 0, frame = 0
 1144              		@ frame_needed = 0, uses_anonymous_args = 0
 1145 0000 08B5     		push	{r3, lr}
 1146              	.LCFI20:
 1147              		.cfi_def_cfa_offset 8
 1148              		.cfi_offset 3, -8
 1149              		.cfi_offset 14, -4
 122:src/aes.c     ****     while (key[len] != '\0') 
 1150              		.loc 1 122 5 view .LVU351
 1151              	.LVL83:
 123:src/aes.c     ****     {
 1152              		.loc 1 123 5 view .LVU352
 122:src/aes.c     ****     while (key[len] != '\0') 
 1153              		.loc 1 122 9 is_stmt 0 view .LVU353
 1154 0002 0023     		movs	r3, #0
 123:src/aes.c     ****     {
 1155              		.loc 1 123 11 view .LVU354
 1156 0004 00E0     		b	.L82
 1157              	.LVL84:
 1158              	.L83:
 125:src/aes.c     ****     }
 1159              		.loc 1 125 9 is_stmt 1 view .LVU355
 125:src/aes.c     ****     }
 1160              		.loc 1 125 12 is_stmt 0 view .LVU356
 1161 0006 0133     		adds	r3, r3, #1
 1162              	.LVL85:
 1163              	.L82:
 123:src/aes.c     ****     {
 1164              		.loc 1 123 11 is_stmt 1 view .LVU357
 123:src/aes.c     ****     {
ARM GAS  /tmp/ccwvKy3T.s 			page 29


 1165              		.loc 1 123 15 is_stmt 0 view .LVU358
 1166 0008 044A     		ldr	r2, .L85
 1167 000a D25C     		ldrb	r2, [r2, r3]	@ zero_extendqisi2
 123:src/aes.c     ****     {
 1168              		.loc 1 123 11 view .LVU359
 1169 000c 002A     		cmp	r2, #0
 1170 000e FAD1     		bne	.L83
 127:src/aes.c     **** 
 1171              		.loc 1 127 5 is_stmt 1 view .LVU360
 129:src/aes.c     ****     {
 1172              		.loc 1 129 5 view .LVU361
 133:src/aes.c     **** 
 1173              		.loc 1 133 5 view .LVU362
 136:src/aes.c     **** }
 1174              		.loc 1 136 5 view .LVU363
 1175 0010 0249     		ldr	r1, .L85
 1176 0012 0348     		ldr	r0, .L85+4
 1177 0014 FFF7FEFF 		bl	expand_key
 1178              	.LVL86:
 137:src/aes.c     **** 
 1179              		.loc 1 137 1 is_stmt 0 view .LVU364
 1180 0018 08BD     		pop	{r3, pc}
 1181              	.L86:
 1182 001a 00BF     		.align	2
 1183              	.L85:
 1184 001c 00000000 		.word	.LANCHOR6
 1185 0020 00000000 		.word	.LANCHOR2
 1186              		.cfi_endproc
 1187              	.LFE137:
 1189              		.section	.text.aes_encryption,"ax",%progbits
 1190              		.align	1
 1191              		.global	aes_encryption
 1192              		.syntax unified
 1193              		.thumb
 1194              		.thumb_func
 1195              		.fpu fpv4-sp-d16
 1197              	aes_encryption:
 1198              	.LVL87:
 1199              	.LFB142:
 251:src/aes.c     ****     for (int i=0; i<16; i++)
 1200              		.loc 1 251 1 is_stmt 1 view -0
 1201              		.cfi_startproc
 1202              		@ args = 0, pretend = 0, frame = 0
 1203              		@ frame_needed = 0, uses_anonymous_args = 0
 251:src/aes.c     ****     for (int i=0; i<16; i++)
 1204              		.loc 1 251 1 is_stmt 0 view .LVU366
 1205 0000 38B5     		push	{r3, r4, r5, lr}
 1206              	.LCFI21:
 1207              		.cfi_def_cfa_offset 16
 1208              		.cfi_offset 3, -16
 1209              		.cfi_offset 4, -12
 1210              		.cfi_offset 5, -8
 1211              		.cfi_offset 14, -4
 252:src/aes.c     ****     {
 1212              		.loc 1 252 5 is_stmt 1 view .LVU367
 1213              	.LBB33:
 252:src/aes.c     ****     {
ARM GAS  /tmp/ccwvKy3T.s 			page 30


 1214              		.loc 1 252 10 view .LVU368
 1215              	.LVL88:
 252:src/aes.c     ****     {
 1216              		.loc 1 252 14 is_stmt 0 view .LVU369
 1217 0002 0023     		movs	r3, #0
 252:src/aes.c     ****     {
 1218              		.loc 1 252 5 view .LVU370
 1219 0004 03E0     		b	.L88
 1220              	.LVL89:
 1221              	.L89:
 254:src/aes.c     ****     }
 1222              		.loc 1 254 9 is_stmt 1 discriminator 3 view .LVU371
 254:src/aes.c     ****     }
 1223              		.loc 1 254 36 is_stmt 0 discriminator 3 view .LVU372
 1224 0006 C15C     		ldrb	r1, [r0, r3]	@ zero_extendqisi2
 254:src/aes.c     ****     }
 1225              		.loc 1 254 24 discriminator 3 view .LVU373
 1226 0008 154A     		ldr	r2, .L93
 1227 000a D154     		strb	r1, [r2, r3]
 252:src/aes.c     ****     {
 1228              		.loc 1 252 25 is_stmt 1 discriminator 3 view .LVU374
 252:src/aes.c     ****     {
 1229              		.loc 1 252 26 is_stmt 0 discriminator 3 view .LVU375
 1230 000c 0133     		adds	r3, r3, #1
 1231              	.LVL90:
 1232              	.L88:
 252:src/aes.c     ****     {
 1233              		.loc 1 252 19 is_stmt 1 discriminator 1 view .LVU376
 252:src/aes.c     ****     {
 1234              		.loc 1 252 5 is_stmt 0 discriminator 1 view .LVU377
 1235 000e 0F2B     		cmp	r3, #15
 1236 0010 F9DD     		ble	.L89
 1237              	.LBE33:
 257:src/aes.c     **** 
 1238              		.loc 1 257 5 is_stmt 1 view .LVU378
 1239 0012 0021     		movs	r1, #0
 1240 0014 1248     		ldr	r0, .L93
 1241              	.LVL91:
 257:src/aes.c     **** 
 1242              		.loc 1 257 5 is_stmt 0 view .LVU379
 1243 0016 FFF7FEFF 		bl	add_round_key
 1244              	.LVL92:
 259:src/aes.c     ****     {
 1245              		.loc 1 259 5 is_stmt 1 view .LVU380
 1246              	.LBB34:
 259:src/aes.c     ****     {
 1247              		.loc 1 259 10 view .LVU381
 259:src/aes.c     ****     {
 1248              		.loc 1 259 14 is_stmt 0 view .LVU382
 1249 001a 0125     		movs	r5, #1
 259:src/aes.c     ****     {
 1250              		.loc 1 259 5 view .LVU383
 1251 001c 0FE0     		b	.L90
 1252              	.LVL93:
 1253              	.L91:
 261:src/aes.c     ****         shift_rows(cipher_text);
 1254              		.loc 1 261 9 is_stmt 1 discriminator 3 view .LVU384
ARM GAS  /tmp/ccwvKy3T.s 			page 31


 1255 001e 104C     		ldr	r4, .L93
 1256 0020 1021     		movs	r1, #16
 1257 0022 2046     		mov	r0, r4
 1258 0024 FFF7FEFF 		bl	sub_bytes
 1259              	.LVL94:
 262:src/aes.c     ****         mix_columns(cipher_text);
 1260              		.loc 1 262 9 discriminator 3 view .LVU385
 1261 0028 2046     		mov	r0, r4
 1262 002a FFF7FEFF 		bl	shift_rows
 1263              	.LVL95:
 263:src/aes.c     ****         add_round_key(cipher_text, i);
 1264              		.loc 1 263 9 discriminator 3 view .LVU386
 1265 002e 2046     		mov	r0, r4
 1266 0030 FFF7FEFF 		bl	mix_columns
 1267              	.LVL96:
 264:src/aes.c     ****     }
 1268              		.loc 1 264 9 discriminator 3 view .LVU387
 1269 0034 E9B2     		uxtb	r1, r5
 1270 0036 2046     		mov	r0, r4
 1271 0038 FFF7FEFF 		bl	add_round_key
 1272              	.LVL97:
 259:src/aes.c     ****     {
 1273              		.loc 1 259 25 discriminator 3 view .LVU388
 259:src/aes.c     ****     {
 1274              		.loc 1 259 26 is_stmt 0 discriminator 3 view .LVU389
 1275 003c 0135     		adds	r5, r5, #1
 1276              	.LVL98:
 1277              	.L90:
 259:src/aes.c     ****     {
 1278              		.loc 1 259 19 is_stmt 1 discriminator 1 view .LVU390
 259:src/aes.c     ****     {
 1279              		.loc 1 259 5 is_stmt 0 discriminator 1 view .LVU391
 1280 003e 092D     		cmp	r5, #9
 1281 0040 EDDD     		ble	.L91
 1282              	.LBE34:
 267:src/aes.c     ****     shift_rows(cipher_text);
 1283              		.loc 1 267 5 is_stmt 1 view .LVU392
 1284 0042 074C     		ldr	r4, .L93
 1285 0044 1021     		movs	r1, #16
 1286 0046 2046     		mov	r0, r4
 1287 0048 FFF7FEFF 		bl	sub_bytes
 1288              	.LVL99:
 268:src/aes.c     ****     add_round_key(cipher_text, 10);
 1289              		.loc 1 268 5 view .LVU393
 1290 004c 2046     		mov	r0, r4
 1291 004e FFF7FEFF 		bl	shift_rows
 1292              	.LVL100:
 269:src/aes.c     **** 
 1293              		.loc 1 269 5 view .LVU394
 1294 0052 0A21     		movs	r1, #10
 1295 0054 2046     		mov	r0, r4
 1296 0056 FFF7FEFF 		bl	add_round_key
 1297              	.LVL101:
 271:src/aes.c     **** }
 1298              		.loc 1 271 5 view .LVU395
 272:src/aes.c     **** 
 1299              		.loc 1 272 1 is_stmt 0 view .LVU396
ARM GAS  /tmp/ccwvKy3T.s 			page 32


 1300 005a 2046     		mov	r0, r4
 1301 005c 38BD     		pop	{r3, r4, r5, pc}
 1302              	.LVL102:
 1303              	.L94:
 272:src/aes.c     **** 
 1304              		.loc 1 272 1 view .LVU397
 1305 005e 00BF     		.align	2
 1306              	.L93:
 1307 0060 00000000 		.word	.LANCHOR7
 1308              		.cfi_endproc
 1309              	.LFE142:
 1311              		.section	.text.aes_decryption,"ax",%progbits
 1312              		.align	1
 1313              		.global	aes_decryption
 1314              		.syntax unified
 1315              		.thumb
 1316              		.thumb_func
 1317              		.fpu fpv4-sp-d16
 1319              	aes_decryption:
 1320              	.LVL103:
 1321              	.LFB146:
 352:src/aes.c     **** 
 353:src/aes.c     **** /**
 354:src/aes.c     ****  * 
 355:src/aes.c     ****  */
 356:src/aes.c     **** uint8_t* aes_decryption(uint8_t* encrypted_text)
 357:src/aes.c     **** {
 1322              		.loc 1 357 1 is_stmt 1 view -0
 1323              		.cfi_startproc
 1324              		@ args = 0, pretend = 0, frame = 0
 1325              		@ frame_needed = 0, uses_anonymous_args = 0
 1326              		.loc 1 357 1 is_stmt 0 view .LVU399
 1327 0000 38B5     		push	{r3, r4, r5, lr}
 1328              	.LCFI22:
 1329              		.cfi_def_cfa_offset 16
 1330              		.cfi_offset 3, -16
 1331              		.cfi_offset 4, -12
 1332              		.cfi_offset 5, -8
 1333              		.cfi_offset 14, -4
 358:src/aes.c     ****     for (int i=0; i<16; i++)
 1334              		.loc 1 358 5 is_stmt 1 view .LVU400
 1335              	.LBB35:
 1336              		.loc 1 358 10 view .LVU401
 1337              	.LVL104:
 1338              		.loc 1 358 14 is_stmt 0 view .LVU402
 1339 0002 0023     		movs	r3, #0
 1340              		.loc 1 358 5 view .LVU403
 1341 0004 03E0     		b	.L96
 1342              	.LVL105:
 1343              	.L97:
 359:src/aes.c     ****     {
 360:src/aes.c     ****         decrypted_text[i] = encrypted_text[i];
 1344              		.loc 1 360 9 is_stmt 1 discriminator 3 view .LVU404
 1345              		.loc 1 360 43 is_stmt 0 discriminator 3 view .LVU405
 1346 0006 C15C     		ldrb	r1, [r0, r3]	@ zero_extendqisi2
 1347              		.loc 1 360 27 discriminator 3 view .LVU406
 1348 0008 154A     		ldr	r2, .L101
ARM GAS  /tmp/ccwvKy3T.s 			page 33


 1349 000a D154     		strb	r1, [r2, r3]
 358:src/aes.c     ****     for (int i=0; i<16; i++)
 1350              		.loc 1 358 25 is_stmt 1 discriminator 3 view .LVU407
 358:src/aes.c     ****     for (int i=0; i<16; i++)
 1351              		.loc 1 358 26 is_stmt 0 discriminator 3 view .LVU408
 1352 000c 0133     		adds	r3, r3, #1
 1353              	.LVL106:
 1354              	.L96:
 358:src/aes.c     ****     for (int i=0; i<16; i++)
 1355              		.loc 1 358 19 is_stmt 1 discriminator 1 view .LVU409
 358:src/aes.c     ****     for (int i=0; i<16; i++)
 1356              		.loc 1 358 5 is_stmt 0 discriminator 1 view .LVU410
 1357 000e 0F2B     		cmp	r3, #15
 1358 0010 F9DD     		ble	.L97
 1359              	.LBE35:
 361:src/aes.c     ****     }
 362:src/aes.c     ****     
 363:src/aes.c     ****     add_round_key(decrypted_text, 10);
 1360              		.loc 1 363 5 is_stmt 1 view .LVU411
 1361 0012 0A21     		movs	r1, #10
 1362 0014 1248     		ldr	r0, .L101
 1363              	.LVL107:
 1364              		.loc 1 363 5 is_stmt 0 view .LVU412
 1365 0016 FFF7FEFF 		bl	add_round_key
 1366              	.LVL108:
 364:src/aes.c     **** 
 365:src/aes.c     ****     for (int i=9; i>0; i--)
 1367              		.loc 1 365 5 is_stmt 1 view .LVU413
 1368              	.LBB36:
 1369              		.loc 1 365 10 view .LVU414
 1370              		.loc 1 365 14 is_stmt 0 view .LVU415
 1371 001a 0925     		movs	r5, #9
 1372              		.loc 1 365 5 view .LVU416
 1373 001c 0FE0     		b	.L98
 1374              	.LVL109:
 1375              	.L99:
 366:src/aes.c     ****     {
 367:src/aes.c     ****         inv_sub_bytes(decrypted_text, 16);
 1376              		.loc 1 367 9 is_stmt 1 discriminator 3 view .LVU417
 1377 001e 104C     		ldr	r4, .L101
 1378 0020 1021     		movs	r1, #16
 1379 0022 2046     		mov	r0, r4
 1380 0024 FFF7FEFF 		bl	inv_sub_bytes
 1381              	.LVL110:
 368:src/aes.c     ****         inv_shift_rows(decrypted_text);
 1382              		.loc 1 368 9 discriminator 3 view .LVU418
 1383 0028 2046     		mov	r0, r4
 1384 002a FFF7FEFF 		bl	inv_shift_rows
 1385              	.LVL111:
 369:src/aes.c     ****         add_round_key(decrypted_text, i);
 1386              		.loc 1 369 9 discriminator 3 view .LVU419
 1387 002e E9B2     		uxtb	r1, r5
 1388 0030 2046     		mov	r0, r4
 1389 0032 FFF7FEFF 		bl	add_round_key
 1390              	.LVL112:
 370:src/aes.c     ****         inv_mix_columns(decrypted_text);
 1391              		.loc 1 370 9 discriminator 3 view .LVU420
ARM GAS  /tmp/ccwvKy3T.s 			page 34


 1392 0036 2046     		mov	r0, r4
 1393 0038 FFF7FEFF 		bl	inv_mix_columns
 1394              	.LVL113:
 365:src/aes.c     ****     {
 1395              		.loc 1 365 24 discriminator 3 view .LVU421
 365:src/aes.c     ****     {
 1396              		.loc 1 365 25 is_stmt 0 discriminator 3 view .LVU422
 1397 003c 013D     		subs	r5, r5, #1
 1398              	.LVL114:
 1399              	.L98:
 365:src/aes.c     ****     {
 1400              		.loc 1 365 19 is_stmt 1 discriminator 1 view .LVU423
 365:src/aes.c     ****     {
 1401              		.loc 1 365 5 is_stmt 0 discriminator 1 view .LVU424
 1402 003e 002D     		cmp	r5, #0
 1403 0040 EDDC     		bgt	.L99
 1404              	.LBE36:
 371:src/aes.c     ****     }
 372:src/aes.c     **** 
 373:src/aes.c     ****     inv_shift_rows(decrypted_text);
 1405              		.loc 1 373 5 is_stmt 1 view .LVU425
 1406 0042 074C     		ldr	r4, .L101
 1407 0044 2046     		mov	r0, r4
 1408 0046 FFF7FEFF 		bl	inv_shift_rows
 1409              	.LVL115:
 374:src/aes.c     ****     inv_sub_bytes(decrypted_text, 16);
 1410              		.loc 1 374 5 view .LVU426
 1411 004a 1021     		movs	r1, #16
 1412 004c 2046     		mov	r0, r4
 1413 004e FFF7FEFF 		bl	inv_sub_bytes
 1414              	.LVL116:
 375:src/aes.c     ****     add_round_key(decrypted_text, 0);
 1415              		.loc 1 375 5 view .LVU427
 1416 0052 0021     		movs	r1, #0
 1417 0054 2046     		mov	r0, r4
 1418 0056 FFF7FEFF 		bl	add_round_key
 1419              	.LVL117:
 376:src/aes.c     **** 
 377:src/aes.c     ****     return decrypted_text;
 1420              		.loc 1 377 5 view .LVU428
 378:src/aes.c     **** }
 1421              		.loc 1 378 1 is_stmt 0 view .LVU429
 1422 005a 2046     		mov	r0, r4
 1423 005c 38BD     		pop	{r3, r4, r5, pc}
 1424              	.LVL118:
 1425              	.L102:
 1426              		.loc 1 378 1 view .LVU430
 1427 005e 00BF     		.align	2
 1428              	.L101:
 1429 0060 00000000 		.word	.LANCHOR8
 1430              		.cfi_endproc
 1431              	.LFE146:
 1433              		.section	.bss.cipher_text,"aw",%nobits
 1434              		.align	2
 1435              		.set	.LANCHOR7,. + 0
 1438              	cipher_text:
 1439 0000 00000000 		.space	16
ARM GAS  /tmp/ccwvKy3T.s 			page 35


 1439      00000000 
 1439      00000000 
 1439      00000000 
 1440              		.section	.bss.decrypted_text,"aw",%nobits
 1441              		.align	2
 1442              		.set	.LANCHOR8,. + 0
 1445              	decrypted_text:
 1446 0000 00000000 		.space	16
 1446      00000000 
 1446      00000000 
 1446      00000000 
 1447              		.section	.bss.key_expansion,"aw",%nobits
 1448              		.align	2
 1449              		.set	.LANCHOR2,. + 0
 1452              	key_expansion:
 1453 0000 00000000 		.space	176
 1453      00000000 
 1453      00000000 
 1453      00000000 
 1453      00000000 
 1454              		.section	.data.key,"aw"
 1455              		.align	2
 1456              		.set	.LANCHOR6,. + 0
 1459              	key:
 1460 0000 30313233 		.ascii	"0123456789012345"
 1460      34353637 
 1460      38393031 
 1460      32333435 
 1461              		.section	.rodata.inv_mix_col,"a"
 1462              		.align	2
 1463              		.set	.LANCHOR5,. + 0
 1466              	inv_mix_col:
 1467 0000 0E0B0D09 		.ascii	"\016\013\015\011\011\016\013\015\015\011\016\013\013"
 1467      090E0B0D 
 1467      0D090E0B 
 1467      0B
 1468 000d 0D090E   		.ascii	"\015\011\016"
 1469              		.section	.rodata.inv_s_box,"a"
 1470              		.align	2
 1471              		.set	.LANCHOR4,. + 0
 1474              	inv_s_box:
 1475 0000 52096AD5 		.ascii	"R\011j\32506\2458\277@\243\236\201\363\327\373|\343"
 1475      3036A538 
 1475      BF40A39E 
 1475      81F3D7FB 
 1475      7CE3
 1476 0012 39829B2F 		.ascii	"9\202\233/\377\2074\216CD\304\336\351\313T{\2242\246"
 1476      FF87348E 
 1476      4344C4DE 
 1476      E9CB547B 
 1476      9432A6
 1477 0025 C2233DEE 		.ascii	"\302#=\356L\225\013B\372\303N\010.\241f(\331$\262v["
 1477      4C950B42 
 1477      FAC34E08 
 1477      2EA16628 
 1477      D924B276 
 1478 003a A2496D8B 		.ascii	"\242Im\213\321%r\370\366d\206h\230\026\324\244\\\314"
ARM GAS  /tmp/ccwvKy3T.s 			page 36


 1478      D12572F8 
 1478      F6648668 
 1478      9816D4A4 
 1478      5CCC
 1479 004c 5D65B692 		.ascii	"]e\266\222lpHP\375\355\271\332^\025FW\247\215\235\204"
 1479      6C704850 
 1479      FDEDB9DA 
 1479      5E154657 
 1479      A78D9D84 
 1480 0060 90D8AB00 		.ascii	"\220\330\253\000\214\274\323\012\367\344X\005\270\263"
 1480      8CBCD30A 
 1480      F7E45805 
 1480      B8B3
 1481 006e 4506D02C 		.ascii	"E\006\320,\036\217\312?\017\002\301\257\275\003\001"
 1481      1E8FCA3F 
 1481      0F02C1AF 
 1481      BD0301
 1482 007d 138A6B3A 		.ascii	"\023\212k:\221\021AOg\334\352\227\362\317\316\360\264"
 1482      9111414F 
 1482      67DCEA97 
 1482      F2CFCEF0 
 1482      B4
 1483 008e E67396AC 		.ascii	"\346s\226\254t\"\347\2555\205\342\3717\350\034u\337"
 1483      7422E7AD 
 1483      3585E2F9 
 1483      37E81C75 
 1483      DF
 1484 009f 6E47F11A 		.ascii	"nG\361\032q\035)\305\211o\267b\016\252\030\276\033\374"
 1484      711D29C5 
 1484      896FB762 
 1484      0EAA18BE 
 1484      1BFC
 1485 00b1 563E4BC6 		.ascii	"V>K\306\322y \232\333\300\376x\315Z\364\037\335\250"
 1485      D279209A 
 1485      DBC0FE78 
 1485      CD5AF41F 
 1485      DDA8
 1486 00c3 338807C7 		.ascii	"3\210\007\3071\261\022\020Y'\200\354_`Q\177\251\031"
 1486      31B11210 
 1486      592780EC 
 1486      5F60517F 
 1486      A919
 1487 00d5 B54A0D2D 		.ascii	"\265J\015-\345z\237\223\311\234\357\240\340;M\256*\365"
 1487      E57A9F93 
 1487      C99CEFA0 
 1487      E03B4DAE 
 1487      2AF5
 1488 00e7 B0C8EBBB 		.ascii	"\260\310\353\273<\203S\231a\027+\004~\272w\326&\341"
 1488      3C835399 
 1488      61172B04 
 1488      7EBA77D6 
 1488      26E1
 1489 00f9 69146355 		.ascii	"i\024cU!\014}"
 1489      210C7D
 1490              		.section	.rodata.mix_col,"a"
 1491              		.align	2
 1492              		.set	.LANCHOR3,. + 0
ARM GAS  /tmp/ccwvKy3T.s 			page 37


 1495              	mix_col:
 1496 0000 02030101 		.ascii	"\002\003\001\001\001\002\003\001\001\001\002\003\003"
 1496      01020301 
 1496      01010203 
 1496      03
 1497 000d 010102   		.ascii	"\001\001\002"
 1498              		.section	.rodata.round_constant,"a"
 1499              		.align	2
 1500              		.set	.LANCHOR1,. + 0
 1503              	round_constant:
 1504 0000 00000000 		.word	0
 1505 0004 00000001 		.word	16777216
 1506 0008 00000002 		.word	33554432
 1507 000c 00000004 		.word	67108864
 1508 0010 00000008 		.word	134217728
 1509 0014 00000010 		.word	268435456
 1510 0018 00000020 		.word	536870912
 1511 001c 00000040 		.word	1073741824
 1512 0020 00000080 		.word	-2147483648
 1513 0024 0000001B 		.word	452984832
 1514 0028 00000036 		.word	905969664
 1515              		.section	.rodata.s_box,"a"
 1516              		.align	2
 1517              		.set	.LANCHOR0,. + 0
 1520              	s_box:
 1521 0000 637C777B 		.ascii	"c|w{\362ko\3050\001g+\376\327\253v\312\202\311}\372"
 1521      F26B6FC5 
 1521      3001672B 
 1521      FED7AB76 
 1521      CA82C97D 
 1522 0015 5947F0AD 		.ascii	"YG\360\255\324\242\257\234\244r\300\267\375\223&6?\367"
 1522      D4A2AF9C 
 1522      A472C0B7 
 1522      FD932636 
 1522      3FF7
 1523 0027 CC34A5E5 		.ascii	"\3144\245\345\361q\3301\025\004\307#\303\030\226\005"
 1523      F171D831 
 1523      1504C723 
 1523      C3189605 
 1524 0037 9A071280 		.ascii	"\232\007\022\200\342\353'\262u\011\203,\032\033nZ\240"
 1524      E2EB27B2 
 1524      7509832C 
 1524      1A1B6E5A 
 1524      A0
 1525 0048 523BD6B3 		.ascii	"R;\326\263)\343/\204S\321\000\355 \374\261[j\313\276"
 1525      29E32F84 
 1525      53D100ED 
 1525      20FCB15B 
 1525      6ACBBE
 1526 005b 394A4C58 		.ascii	"9JLX\317\320\357\252\373CM3\205E\371\002\177P<\237\250"
 1526      CFD0EFAA 
 1526      FB434D33 
 1526      8545F902 
 1526      7F503C9F 
 1527 0070 51A3408F 		.ascii	"Q\243@\217\222\2358\365\274\266\332!\020\377\363\322"
 1527      929D38F5 
 1527      BCB6DA21 
ARM GAS  /tmp/ccwvKy3T.s 			page 38


 1527      10FFF3D2 
 1528 0080 CD0C13EC 		.ascii	"\315\014\023\354_\227D\027\304\247~=d]\031s`\201O\334"
 1528      5F974417 
 1528      C4A77E3D 
 1528      645D1973 
 1528      60814FDC 
 1529 0094 222A9088 		.ascii	"\"*\220\210F\356\270\024\336^\013\333\3402:\012I\006"
 1529      46EEB814 
 1529      DE5E0BDB 
 1529      E0323A0A 
 1529      4906
 1530 00a6 245CC2D3 		.ascii	"$\\\302\323\254b\221\225\344y\347\3107m\215\325N\251"
 1530      AC629195 
 1530      E479E7C8 
 1530      376D8DD5 
 1530      4EA9
 1531 00b8 6C56F4EA 		.ascii	"lV\364\352ez\256\010\272x%.\034\246\264\306\350\335"
 1531      657AAE08 
 1531      BA78252E 
 1531      1CA6B4C6 
 1531      E8DD
 1532 00ca 741F4BBD 		.ascii	"t\037K\275\213\212p>\265fH\003\366\016a5W\271\206\301"
 1532      8B8A703E 
 1532      B5664803 
 1532      F60E6135 
 1532      57B986C1 
 1533 00de 1D9EE1F8 		.ascii	"\035\236\341\370\230\021i\331\216\224\233\036\207\351"
 1533      981169D9 
 1533      8E949B1E 
 1533      87E9
 1534 00ec CE5528DF 		.ascii	"\316U(\337\214\241\211\015\277\346BhA\231-\017\260T"
 1534      8CA1890D 
 1534      BFE64268 
 1534      41992D0F 
 1534      B054
 1535 00fe BB16     		.ascii	"\273\026"
 1536              		.text
 1537              	.Letext0:
 1538              		.file 2 "/usr/lib/gcc/arm-none-eabi/10.3.1/include/stdint.h"
ARM GAS  /tmp/ccwvKy3T.s 			page 39


DEFINED SYMBOLS
                            *ABS*:0000000000000000 aes.c
     /tmp/ccwvKy3T.s:18     .text.sub_bytes:0000000000000000 $t
     /tmp/ccwvKy3T.s:25     .text.sub_bytes:0000000000000000 sub_bytes
     /tmp/ccwvKy3T.s:97     .text.sub_bytes:0000000000000028 $d
     /tmp/ccwvKy3T.s:102    .text.compute_g:0000000000000000 $t
     /tmp/ccwvKy3T.s:108    .text.compute_g:0000000000000000 compute_g
     /tmp/ccwvKy3T.s:166    .text.compute_g:000000000000002c $d
     /tmp/ccwvKy3T.s:171    .text.expand_key:0000000000000000 $t
     /tmp/ccwvKy3T.s:177    .text.expand_key:0000000000000000 expand_key
     /tmp/ccwvKy3T.s:318    .text.add_round_key:0000000000000000 $t
     /tmp/ccwvKy3T.s:324    .text.add_round_key:0000000000000000 add_round_key
     /tmp/ccwvKy3T.s:406    .text.add_round_key:0000000000000058 $d
     /tmp/ccwvKy3T.s:411    .text.shift_rows:0000000000000000 $t
     /tmp/ccwvKy3T.s:417    .text.shift_rows:0000000000000000 shift_rows
     /tmp/ccwvKy3T.s:532    .text.gfmul:0000000000000000 $t
     /tmp/ccwvKy3T.s:538    .text.gfmul:0000000000000000 gfmul
     /tmp/ccwvKy3T.s:628    .text.mix_columns:0000000000000000 $t
     /tmp/ccwvKy3T.s:634    .text.mix_columns:0000000000000000 mix_columns
     /tmp/ccwvKy3T.s:775    .text.mix_columns:000000000000007c $d
     /tmp/ccwvKy3T.s:780    .text.inv_sub_bytes:0000000000000000 $t
     /tmp/ccwvKy3T.s:786    .text.inv_sub_bytes:0000000000000000 inv_sub_bytes
     /tmp/ccwvKy3T.s:857    .text.inv_sub_bytes:0000000000000028 $d
     /tmp/ccwvKy3T.s:862    .text.inv_shift_rows:0000000000000000 $t
     /tmp/ccwvKy3T.s:868    .text.inv_shift_rows:0000000000000000 inv_shift_rows
     /tmp/ccwvKy3T.s:983    .text.inv_mix_columns:0000000000000000 $t
     /tmp/ccwvKy3T.s:989    .text.inv_mix_columns:0000000000000000 inv_mix_columns
     /tmp/ccwvKy3T.s:1127   .text.inv_mix_columns:000000000000007c $d
     /tmp/ccwvKy3T.s:1132   .text.aes_init:0000000000000000 $t
     /tmp/ccwvKy3T.s:1139   .text.aes_init:0000000000000000 aes_init
     /tmp/ccwvKy3T.s:1184   .text.aes_init:000000000000001c $d
     /tmp/ccwvKy3T.s:1190   .text.aes_encryption:0000000000000000 $t
     /tmp/ccwvKy3T.s:1197   .text.aes_encryption:0000000000000000 aes_encryption
     /tmp/ccwvKy3T.s:1307   .text.aes_encryption:0000000000000060 $d
     /tmp/ccwvKy3T.s:1312   .text.aes_decryption:0000000000000000 $t
     /tmp/ccwvKy3T.s:1319   .text.aes_decryption:0000000000000000 aes_decryption
     /tmp/ccwvKy3T.s:1429   .text.aes_decryption:0000000000000060 $d
     /tmp/ccwvKy3T.s:1434   .bss.cipher_text:0000000000000000 $d
     /tmp/ccwvKy3T.s:1438   .bss.cipher_text:0000000000000000 cipher_text
     /tmp/ccwvKy3T.s:1441   .bss.decrypted_text:0000000000000000 $d
     /tmp/ccwvKy3T.s:1445   .bss.decrypted_text:0000000000000000 decrypted_text
     /tmp/ccwvKy3T.s:1448   .bss.key_expansion:0000000000000000 $d
     /tmp/ccwvKy3T.s:1452   .bss.key_expansion:0000000000000000 key_expansion
     /tmp/ccwvKy3T.s:1455   .data.key:0000000000000000 $d
     /tmp/ccwvKy3T.s:1459   .data.key:0000000000000000 key
     /tmp/ccwvKy3T.s:1462   .rodata.inv_mix_col:0000000000000000 $d
     /tmp/ccwvKy3T.s:1466   .rodata.inv_mix_col:0000000000000000 inv_mix_col
     /tmp/ccwvKy3T.s:1470   .rodata.inv_s_box:0000000000000000 $d
     /tmp/ccwvKy3T.s:1474   .rodata.inv_s_box:0000000000000000 inv_s_box
     /tmp/ccwvKy3T.s:1491   .rodata.mix_col:0000000000000000 $d
     /tmp/ccwvKy3T.s:1495   .rodata.mix_col:0000000000000000 mix_col
     /tmp/ccwvKy3T.s:1499   .rodata.round_constant:0000000000000000 $d
     /tmp/ccwvKy3T.s:1503   .rodata.round_constant:0000000000000000 round_constant
     /tmp/ccwvKy3T.s:1516   .rodata.s_box:0000000000000000 $d
     /tmp/ccwvKy3T.s:1520   .rodata.s_box:0000000000000000 s_box

NO UNDEFINED SYMBOLS
ARM GAS  /tmp/ccwvKy3T.s 			page 40


